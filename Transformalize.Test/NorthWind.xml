<?xml version="1.0" encoding="utf-8" ?>
<process>

  <connections>
    <add name="input" value="Server=localhost;Database=NorthWind;Trusted_Connection=True;"/>
    <add name="output" value="Server=localhost;Database=NorthWindStar;Trusted_Connection=True;"/>
    <add name="ssas" value="Data Source=localhost;Catalog=NorthWind;" type="AnalysisServices"></add>
  </connections>

  <entities>
    <add name="Order Details" version="RowVersion" auto="true">
      <fields>
        <add name="RowVersion" alias="OrderDetailsRowVersion" type="byte[]" output="false"></add>
      </fields>
      <transforms>
        <add method="javascript" script="OrderDetailsQuantity * OrderDetailsUnitPrice">
          <results>
            <add name="OrderDetailsExtendedPrice" type="Decimal" precision="19" scale="4"/>
          </results>
        </add>
      </transforms>
    </add>
    <add name="Orders" version="RowVersion" auto="true">
      <fields>
        <add name="RowVersion" alias="OrdersRowVersion" type="byte[]" output="false"></add>
      </fields>
      
      <transforms>
        <add method="dateformat" format="yyyy-MM-dd" parameter="OrdersOrderDate" result="TimeOrderDate" />
        <add method="dateformat" format="MM-MMM" parameter="OrdersOrderDate">
          <results>
            <add name="TimeOrderMonth" length="6" default="12-DEC">
              <transforms>
                <add method="toUpper"></add>
              </transforms>
            </add>
          </results>
        </add>
        <add method="dateformat" format="yyyy" parameter="OrdersOrderDate" result="TimeOrderYear" />
      </transforms>

    </add>
    <add name="Customers" version="RowVersion" auto="true">
      <fields>
        <add name="RowVersion" alias="CustomersRowVersion" type="byte[]" output="false"></add>
      </fields>
    </add>
    <add name="Employees" version="RowVersion" auto="true">
      <fields>
        <add name="RowVersion" alias="EmployeesRowVersion" type="byte[]" output="false"></add>
        <add name="ReportsTo" alias="EmployeesManager" type="string" length="64">
          <transforms>
            <add method="map" map="Managers"></add>
          </transforms>
        </add>
        <add name="Photo" alias="EmployeesPhoto" input="false"></add>
        <add name="PhotoPath" alias="EmployeesPhotoPath" input="false"></add>
      </fields>
      <transforms>
        <add method="join" separator=" " result="Employee">
          <parameters>
            <!--<add field="TitleOfCourtesy"></add>-->
            <add field="FirstName"></add>
            <add field="LastName"></add>
          </parameters>
        </add>
      </transforms>
    </add>
    <add name="Products" version="RowVersion" auto="true">
      <fields>
        <add name="RowVersion" alias="ProductsRowVersion" type="byte[]" output="false"></add>
      </fields>
    </add>
    <add name="Suppliers" version="RowVersion" auto="true">
      <fields>
        <add name="RowVersion" alias="SuppliersRowVersion" type="byte[]" output="false"></add>
      </fields>
    </add>
    <add name="Categories" version="RowVersion" auto="true">
      <fields>
        <add name="RowVersion" alias="CategoriesRowVersion" type="byte[]" input="false"></add>
        <add name="Picture" alias="CategoriesPicture" type="byte[]" input="false"></add>
      </fields>
    </add>
    <add name="Shippers" version="RowVersion" auto="true">
      <fields>
        <add name="RowVersion" alias="ShippersRowVersion" type="byte[]" output="false"></add>
      </fields>
    </add>
  </entities>

  <relationships>
    <add leftEntity="Order Details" leftField="OrderID" rightEntity="Orders" rightField="OrderID"/>
    <add leftEntity="Orders" leftField="CustomerID" rightEntity="Customers" rightField="CustomerID"/>
    <add leftEntity="Orders" leftField="EmployeeID" rightEntity="Employees" rightField="EmployeeID"/>
    <add leftEntity="Orders" leftField="ShipVia" rightEntity="Shippers" rightField="ShipperID"/>
    <add leftEntity="Order Details" leftField="ProductID" rightEntity="Products" rightField="ProductID"/>
    <add leftEntity="Products" leftField="SupplierID" rightEntity="Suppliers" rightField="SupplierID"/>
    <add leftEntity="Products" leftField="CategoryID" rightEntity="Categories" rightField="CategoryID"/>
  </relationships>

  <maps>
    <add name="Managers" connection="input">
      <items sql="select EmployeeID, FirstName + ' ' + LastName FROM Employees;"/>
    </add>
  </maps>

</process>
