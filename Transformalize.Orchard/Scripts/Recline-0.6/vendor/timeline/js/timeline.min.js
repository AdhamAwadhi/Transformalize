/*!
	TimelineJS
	Version 2.17
	Designed and built by Zach Wise at VéritéCo
	This Source Code Form is subject to the terms of the Mozilla Public
	License, v. 2.0. If a copy of the MPL was not distributed with this
	file, You can obtain one at http://mozilla.org/MPL/2.0/.
	
*/
/*!
	StoryJS
	Designed and built by Zach Wise at VéritéCo
	This Source Code Form is subject to the terms of the Mozilla Public
	License, v. 2.0. If a copy of the MPL was not distributed with this
	file, You can obtain one at http://mozilla.org/MPL/2.0/.
*/
function trace(n){VMM.debug&&(window.console?console.log(n):typeof jsTrace!="undefined"&&jsTrace.send(n))}function onYouTubePlayerAPIReady(){trace("GLOBAL YOUTUBE API CALLED");VMM.ExternalAPI.youtube.onAPIReady()}var global,VMM,is,type,dateFormat,Aes,Base64,Utf8;(function(){var n=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(i){function u(){!n&&this.init&&this.init.apply(this,arguments)}var e=this.prototype,f,r;n=!0;f=new this;n=!1;for(r in i)f[r]=typeof i[r]=="function"&&typeof e[r]=="function"&&t.test(i[r])?function(n,t){return function(){var r=this._super,i;return this._super=e[n],i=t.apply(this,arguments),this._super=r,i}}(r,i[r]):i[r];return u.prototype=f,u.prototype.constructor=u,u.extend=arguments.callee,u}})();global=function(){return this||eval("this")}();typeof VMM=="undefined"&&(VMM=Class.extend({}),VMM.debug=!0,VMM.master_config={init:function(){return this},sizes:{api:{width:0,height:0}},vp:"Pellentesque nibh felis, eleifend id, commodo in, interdum vitae, leo",api_keys_master:{flickr:"RAIvxHY4hE/Elm5cieh4X5ptMyDpj7MYIxziGxi0WGCcy1s+yr7rKQ==",google:"uQKadH1VMlCsp560gN2aOiMz4evWkl1s34yryl3F/9FJOsn+/948CbBUvKLN46U=",twitter:""},timers:{api:7e3},api:{pushques:[]},twitter:{active:!1,array:[],api_loaded:!1,que:[]},flickr:{active:!1,array:[],api_loaded:!1,que:[]},youtube:{active:!1,array:[],api_loaded:!1,que:[]},vimeo:{active:!1,array:[],api_loaded:!1,que:[]},vine:{active:!1,array:[],api_loaded:!1,que:[]},webthumb:{active:!1,array:[],api_loaded:!1,que:[]},googlemaps:{active:!1,map_active:!1,places_active:!1,array:[],api_loaded:!1,que:[]},googledocs:{active:!1,array:[],api_loaded:!1,que:[]},googleplus:{active:!1,array:[],api_loaded:!1,que:[]},wikipedia:{active:!1,array:[],api_loaded:!1,que:[],tries:0},soundcloud:{active:!1,array:[],api_loaded:!1,que:[]}}.init(),VMM.createElement=function(n,t,i,r,u){var f="";return n!=null&&n!=""&&(f+="<"+n,i!=null&&i!=""&&(f+=" class='"+i+"'"),r!=null&&r!=""&&(f+=" "+r),u!=null&&u!=""&&(f+=" style='"+u+"'"),f+=">",t!=null&&t!=""&&(f+=t),f=f+"<\/"+n+">"),f},VMM.createMediaElement=function(n,t,i){var r="";return r+="<div class='media'>",n!=null&&n!=""&&(valid=!0,r+="<img src='"+n+"'>",i!=null&&i!=""&&(r+=VMM.createElement("div",i,"credit")),t!=null&&t!=""&&(r+=VMM.createElement("div",t,"caption"))),r+"<\/div>"},VMM.hideUrlBar=function(){var n=window,i=n.document,t,r;location.hash&&n.addEventListener||(window.scrollTo(0,1),t=1,r=setInterval(function(){i.body&&(clearInterval(r),t="scrollTop"in i.body?i.body.scrollTop:1,n.scrollTo(0,t===1?0:1))},15),n.addEventListener("load",function(){setTimeout(function(){n.scrollTo(0,t===1?0:1)},0)},!1))});Array.prototype.remove=function(n,t){var i=this.slice((t||n)+1||this.length);return this.length=n<0?this.length+n:n,this.push.apply(this,i)};Date.prototype.getWeek=function(){var n=new Date(this.getFullYear(),0,1);return Math.ceil(((this-n)/864e5+n.getDay()+1)/7)};Date.prototype.getDayOfYear=function(){var n=new Date(this.getFullYear(),0,1);return Math.ceil((this-n)/864e5)};is={Null:function(n){return n===null},Undefined:function(n){return n===undefined},nt:function(n){return n===null||n===undefined},Function:function(n){return typeof n=="function"?n.constructor.toString().match(/Function/)!==null:!1},String:function(n){return typeof n=="string"?!0:typeof n=="object"?n.constructor.toString().match(/string/i)!==null:!1},Array:function(n){return typeof n=="object"?n.constructor.toString().match(/array/i)!==null||n.length!==undefined:!1},Boolean:function(n){return typeof n=="boolean"?!0:typeof n=="object"?n.constructor.toString().match(/boolean/i)!==null:!1},Date:function(n){return typeof n=="date"?!0:typeof n=="object"?n.constructor.toString().match(/date/i)!==null:!1},HTML:function(n){return typeof n=="object"?n.constructor.toString().match(/html/i)!==null:!1},Number:function(n){return typeof n=="number"?!0:typeof n=="object"?n.constructor.toString().match(/Number/)!==null:!1},Object:function(n){return typeof n=="object"?n.constructor.toString().match(/object/i)!==null:!1},RegExp:function(n){return typeof n=="function"?n.constructor.toString().match(/regexp/i)!==null:!1}};type={of:function(n){for(var t in is)if(is[t](n))return t.toLowerCase()}};typeof VMM!="undefined"&&(VMM.smoothScrollTo=function(n,t,i){if(typeof jQuery!="undefined"){var r="easein",u=1e3;t!=null&&(u=t<1?1:Math.round(t));i!=null&&i!=""&&(r=i);jQuery(window).scrollTop()!=VMM.Lib.offset(n).top&&VMM.Lib.animate("html,body",u,r,{scrollTop:VMM.Lib.offset(n).top})}},VMM.attachElement=function(n,t){typeof jQuery!="undefined"&&jQuery(n).html(t)},VMM.appendElement=function(n,t){typeof jQuery!="undefined"&&jQuery(n).append(t)},VMM.getHTML=function(n){if(typeof jQuery!="undefined")return jQuery(n).html()},VMM.getElement=function(n,t){if(typeof jQuery!="undefined")return t?jQuery(n).parent().get(0):jQuery(n).get(0)},VMM.bindEvent=function(n,t,i,r){var f="click",u={};i!=null&&i!=""&&(f=i);u!=null&&u!=""&&(u=r);typeof jQuery!="undefined"&&jQuery(n).bind(f,u,t)},VMM.unbindEvent=function(n,t,i){var r="click";i!=null&&i!=""&&(r=i);typeof jQuery!="undefined"&&jQuery(n).unbind(r,t)},VMM.fireEvent=function(n,t,i){var r="click",u=[];t!=null&&t!=""&&(r=t);i!=null&&i!=""&&(u=i);typeof jQuery!="undefined"&&jQuery(n).trigger(r,u)},VMM.getJSON=function(n,t,i){if(typeof jQuery!="undefined"){if(jQuery.ajaxSetup({timeout:3e3}),VMM.Browser.browser=="Explorer"&&parseInt(VMM.Browser.version,10)>=7&&window.XDomainRequest){trace("IE JSON");var r=n;return r.match("^http://")?jQuery.getJSON(r,t,i):r.match("^https://")?(r=r.replace("https://","http://"),jQuery.getJSON(r,t,i)):jQuery.getJSON(n,t,i)}return jQuery.getJSON(n,t,i)}},VMM.parseJSON=function(n){if(typeof jQuery!="undefined")return jQuery.parseJSON(n)},VMM.appendAndGetElement=function(n,t,i,r){var u,o="<div>",f="",e="";return t!=null&&t!=""&&(o=t),i!=null&&i!=""&&(f=i),r!=null&&r!=""&&(e=r),typeof jQuery!="undefined"&&(u=jQuery(t),u.addClass(f),u.html(e),jQuery(n).append(u)),u},VMM.Lib={init:function(){return this},hide:function(n,t){t!=null&&t!=""?typeof jQuery!="undefined"&&jQuery(n).hide(t):typeof jQuery!="undefined"&&jQuery(n).hide()},remove:function(n){typeof jQuery!="undefined"&&jQuery(n).remove()},detach:function(n){typeof jQuery!="undefined"&&jQuery(n).detach()},append:function(n,t){typeof jQuery!="undefined"&&jQuery(n).append(t)},prepend:function(n,t){typeof jQuery!="undefined"&&jQuery(n).prepend(t)},show:function(n,t){t!=null&&t!=""?typeof jQuery!="undefined"&&jQuery(n).show(t):typeof jQuery!="undefined"&&jQuery(n).show()},load:function(n,t,i){var r={elem:n};r!=null&&r!=""&&(r=i);typeof jQuery!="undefined"&&jQuery(n).load(r,t)},addClass:function(n,t){typeof jQuery!="undefined"&&jQuery(n).addClass(t)},removeClass:function(n,t){typeof jQuery!="undefined"&&jQuery(n).removeClass(t)},attr:function(n,t,i){if(i!=null&&i!="")typeof jQuery!="undefined"&&jQuery(n).attr(t,i);else if(typeof jQuery!="undefined")return jQuery(n).attr(t)},prop:function(n,t,i){typeof jQuery!="undefined"&&/[1-9]\.[3-9].[1-9]/.test(jQuery.fn.jquery)?jQuery(n).prop(t,i):VMM.Lib.attribute(n,t,i)},attribute:function(n,t,i){if(i!=null&&i!="")typeof jQuery!="undefined"&&jQuery(n).attr(t,i);else if(typeof jQuery!="undefined")return jQuery(n).attr(t)},visible:function(n,t){if(t!=null)typeof jQuery!="undefined"&&(t?jQuery(n).show(0):jQuery(n).hide(0));else if(typeof jQuery!="undefined")return jQuery(n).is(":visible")?!0:!1},css:function(n,t,i){if(i!=null&&i!="")typeof jQuery!="undefined"&&jQuery(n).css(t,i);else if(typeof jQuery!="undefined")return jQuery(n).css(t)},cssmultiple:function(n,t){if(typeof jQuery!="undefined")return jQuery(n).css(t)},offset:function(n){var t;return typeof jQuery!="undefined"&&(t=jQuery(n).offset()),t},position:function(n){var t;return typeof jQuery!="undefined"&&(t=jQuery(n).position()),t},width:function(n,t){if(t!=null&&t!="")typeof jQuery!="undefined"&&jQuery(n).width(t);else if(typeof jQuery!="undefined")return jQuery(n).width()},height:function(n,t){if(t!=null&&t!="")typeof jQuery!="undefined"&&jQuery(n).height(t);else if(typeof jQuery!="undefined")return jQuery(n).height()},toggleClass:function(n,t){typeof jQuery!="undefined"&&jQuery(n).toggleClass(t)},each:function(n,t){typeof jQuery!="undefined"&&jQuery(n).each(t)},html:function(n,t){var i;if(typeof jQuery!="undefined")return jQuery(n).html();if(t!=null&&t!="")typeof jQuery!="undefined"&&jQuery(n).html(t);else if(typeof jQuery!="undefined")return jQuery(n).html()},find:function(n,t){if(typeof jQuery!="undefined")return jQuery(n).find(t)},stop:function(n){typeof jQuery!="undefined"&&jQuery(n).stop()},delay_animate:function(n,t,i,r,u){if(VMM.Browser.device=="mobile"||VMM.Browser.device=="tablet"){var e=Math.round(i/150)/10,f=e+"s";VMM.Lib.css(t,"-webkit-transition","all "+f+" ease");VMM.Lib.css(t,"-moz-transition","all "+f+" ease");VMM.Lib.css(t,"-o-transition","all "+f+" ease");VMM.Lib.css(t,"-ms-transition","all "+f+" ease");VMM.Lib.css(t,"transition","all "+f+" ease");VMM.Lib.cssmultiple(t,_att)}else typeof jQuery!="undefined"&&jQuery(t).delay(n).animate(u,{duration:i,easing:r})},animate:function(n,t,i,r,u,f){var e="easein",c=!1,h=1e3,o={},l,s;if(t!=null&&(h=t<1?1:Math.round(t)),i!=null&&i!=""&&(e=i),u!=null&&u!=""&&(c=u),o=r!=null?r:{opacity:0},VMM.Browser.device=="mobile"||VMM.Browser.device=="tablet"){l=Math.round(h/150)/10;s=l+"s";e=" cubic-bezier(0.33, 0.66, 0.66, 1)";for(x in o)Object.prototype.hasOwnProperty.call(o,x)&&(trace(x+" to "+o[x]),VMM.Lib.css(n,"-webkit-transition",x+" "+s+e),VMM.Lib.css(n,"-moz-transition",x+" "+s+e),VMM.Lib.css(n,"-o-transition",x+" "+s+e),VMM.Lib.css(n,"-ms-transition",x+" "+s+e),VMM.Lib.css(n,"transition",x+" "+s+e));VMM.Lib.cssmultiple(n,o)}else typeof jQuery!="undefined"&&(f!=null&&f!=""?jQuery(n).animate(o,{queue:c,duration:h,easing:e,complete:f}):jQuery(n).animate(o,{queue:c,duration:h,easing:e}))}});typeof jQuery!="undefined"&&(function(n){window.XDomainRequest&&n.ajaxTransport(function(t){if(t.crossDomain&&t.async){t.timeout&&(t.xdrTimeout=t.timeout,delete t.timeout);var i;return{send:function(r,u){function f(t,r,f,e){i.onload=i.onerror=i.ontimeout=n.noop;i=undefined;u(t,r,f,e)}i=new XDomainRequest;i.open(t.type,t.url);i.onload=function(){f(200,"OK",{text:i.responseText},"Content-Type: "+i.contentType)};i.onerror=function(){f(404,"Not Found")};t.xdrTimeout&&(i.ontimeout=function(){f(0,"timeout")},i.timeout=t.xdrTimeout);i.send(t.hasContent&&t.data||null)},abort:function(){i&&(i.onerror=n.noop(),i.abort())}}}})}(jQuery),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(n,t,i,r,u){return jQuery.easing[jQuery.easing.def](n,t,i,r,u)},easeInExpo:function(n,t,i,r,u){return t==0?i:r*Math.pow(2,10*(t/u-1))+i},easeOutExpo:function(n,t,i,r,u){return t==u?i+r:r*(-Math.pow(2,-10*t/u)+1)+i},easeInOutExpo:function(n,t,i,r,u){return t==0?i:t==u?i+r:(t/=u/2)<1?r/2*Math.pow(2,10*(t-1))+i:r/2*(-Math.pow(2,-10*--t)+2)+i},easeInQuad:function(n,t,i,r,u){return r*(t/=u)*t+i},easeOutQuad:function(n,t,i,r,u){return-r*(t/=u)*(t-2)+i},easeInOutQuad:function(n,t,i,r,u){return(t/=u/2)<1?r/2*t*t+i:-r/2*(--t*(t-2)-1)+i}}));typeof VMM!="undefined"&&typeof VMM.Browser=="undefined"&&(VMM.Browser={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS";this.device=this.searchDevice(navigator.userAgent);this.orientation=this.searchOrientation(window.orientation)},searchOrientation:function(n){return n==0||n==180?"portrait":n==90||n==-90?"landscape":"normal"},searchDevice:function(n){return n.match(/Android/i)||n.match(/iPhone|iPod/i)?"mobile":n.match(/iPad/i)?"tablet":n.match(/BlackBerry/i)||n.match(/IEMobile/i)?"other mobile":"desktop"},searchString:function(n){for(var i,r,t=0;t<n.length;t++)if(i=n[t].string,r=n[t].prop,this.versionSearchString=n[t].versionSearch||n[t].identity,i){if(i.indexOf(n[t].subString)!=-1)return n[t].identity}else if(r)return n[t].identity},searchVersion:function(n){var t=n.indexOf(this.versionSearchString);if(t!=-1)return parseFloat(n.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},VMM.Browser.init());typeof VMM!="undefined"&&typeof VMM.FileExtention=="undefined"&&(VMM.FileExtention={googleDocType:function(n){for(var i=n.replace(/\s\s*$/,""),r="",u=["DOC","DOCX","XLS","XLSX","PPT","PPTX","PDF","PAGES","AI","PSD","TIFF","DXF","SVG","EPS","PS","TTF","XPS","ZIP","RAR"],f=!1,r=i.substr(i.length-5,5),t=0;t<u.length;t++)(r.toLowerCase().match(u[t].toString().toLowerCase())||i.match("docs.google.com"))&&(f=!0);return f}});typeof VMM!="undefined"&&typeof VMM.Date=="undefined"&&(VMM.Date={init:function(){return this},dateformats:{year:"yyyy",month_short:"mmm",month:"mmmm yyyy",full_short:"mmm d",full:"mmmm d',' yyyy",time_no_seconds_short:"h:MM TT",time_no_seconds_small_date:"h:MM TT'<br/><small>'mmmm d',' yyyy'<\/small>'",full_long:"mmm d',' yyyy 'at' hh:MM TT",full_long_small_date:"hh:MM TT'<br/><small>mmm d',' yyyy'<\/small>'"},month:["January","February","March","April","May","June","July","August","September","October","November","December"],month_abbr:["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_abbr:["Sun.","Mon.","Tues.","Wed.","Thurs.","Fri.","Sat."],hour:[1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12],hour_suffix:["am"],bc_format:{year:"yyyy",month_short:"mmm",month:"mmmm yyyy",full_short:"mmm d",full:"mmmm d',' yyyy",time_no_seconds_short:"h:MM TT",time_no_seconds_small_date:"dddd', 'h:MM TT'<br/><small>'mmmm d',' yyyy'<\/small>'",full_long:"dddd',' mmm d',' yyyy 'at' hh:MM TT",full_long_small_date:"hh:MM TT'<br/><small>'dddd',' mmm d',' yyyy'<\/small>'"},setLanguage:function(n){trace("SET DATE LANGUAGE");VMM.Date.dateformats=n.dateformats;VMM.Date.month=n.date.month;VMM.Date.month_abbr=n.date.month_abbr;VMM.Date.day=n.date.day;VMM.Date.day_abbr=n.date.day_abbr;dateFormat.i18n.dayNames=n.date.day_abbr.concat(n.date.day);dateFormat.i18n.monthNames=n.date.month_abbr.concat(n.date.month)},parse:function(n,t){"use strict";var r,u,f,o,i={year:!1,month:!1,day:!1,hour:!1,minute:!1,second:!1,millisecond:!1},s,e;if(type.of(n)=="date")trace("DEBUG THIS, ITs A DATE"),r=n;else if(r=new Date(0,0,1,0,0,0,0),n.match(/,/gi)){for(u=n.split(","),s=0;s<u.length;s++)u[s]=parseInt(u[s],10);u[0]&&(r.setFullYear(u[0]),i.year=!0);u[1]&&(r.setMonth(u[1]-1),i.month=!0);u[2]&&(r.setDate(u[2]),i.day=!0);u[3]&&(r.setHours(u[3]),i.hour=!0);u[4]&&(r.setMinutes(u[4]),i.minute=!0);u[5]&&(r.setSeconds(u[5]),i.second=!0);u[6]&&(r.setMilliseconds(u[6]),i.millisecond=!0)}else n.match("/")?(n.match(" ")?(o=n.split(" "),n.match(":")&&(f=o[1].split(":"),f[0]>=0&&(r.setHours(f[0]),i.hour=!0),f[1]>=0&&(r.setMinutes(f[1]),i.minute=!0),f[2]>=0&&(r.setSeconds(f[2]),i.second=!0),f[3]>=0&&(r.setMilliseconds(f[3]),i.millisecond=!0)),u=o[0].split("/")):u=n.split("/"),u[2]&&(r.setFullYear(u[2]),i.year=!0),u[0]>=0&&(r.setMonth(u[0]-1),i.month=!0),u[1]>=0&&(u[1].length>2?(r.setFullYear(u[1]),i.year=!0):(r.setDate(u[1]),i.day=!0))):n.match("now")?(e=new Date,r.setFullYear(e.getFullYear()),i.year=!0,r.setMonth(e.getMonth()),i.month=!0,r.setDate(e.getDate()),i.day=!0,n.match("hours")&&(r.setHours(e.getHours()),i.hour=!0),n.match("minutes")&&(r.setHours(e.getHours()),r.setMinutes(e.getMinutes()),i.hour=!0,i.minute=!0),n.match("seconds")&&(r.setHours(e.getHours()),r.setMinutes(e.getMinutes()),r.setSeconds(e.getSeconds()),i.hour=!0,i.minute=!0,i.second=!0),n.match("milliseconds")&&(r.setHours(e.getHours()),r.setMinutes(e.getMinutes()),r.setSeconds(e.getSeconds()),r.setMilliseconds(e.getMilliseconds()),i.hour=!0,i.minute=!0,i.second=!0,i.millisecond=!0)):n.length<=8?(i.year=!0,r.setFullYear(parseInt(n,10)),r.setMonth(0),r.setDate(1),r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)):n.match("T")?navigator.userAgent.match(/MSIE\s(?!9.0)/)?(o=n.split("T"),n.match(":")&&(f=o[1].split(":"),f[0]>=1&&(r.setHours(f[0]),i.hour=!0),f[1]>=1&&(r.setMinutes(f[1]),i.minute=!0),f[2]>=1&&(r.setSeconds(f[2]),i.second=!0),f[3]>=1&&(r.setMilliseconds(f[3]),i.millisecond=!0)),u=o[0].split("-"),u[0]&&(r.setFullYear(u[0]),i.year=!0),u[1]>=0&&(r.setMonth(u[1]-1),i.month=!0),u[2]>=0&&(r.setDate(u[2]),i.day=!0)):(r=new Date(Date.parse(n)),i.year=!0,i.month=!0,i.day=!0,i.hour=!0,i.minute=!0,i.second=!0,i.millisecond=!0):(i.year=!0,i.month=!0,i.day=!0,i.hour=!0,i.minute=!0,i.second=!0,i.millisecond=!0,r=new Date(parseInt(n.slice(0,4),10),parseInt(n.slice(4,6),10)-1,parseInt(n.slice(6,8),10),parseInt(n.slice(8,10),10),parseInt(n.slice(10,12),10)));return t!=null&&t!=""?{date:r,precision:i}:r},prettyDate:function(n,t,i,r){var f,s,a,u,v=!1,h,c,l,e,o;if(r!=null&&r!=""&&typeof r!="undefined"&&(v=!0,trace("D2 "+r)),type.of(n)=="date"){for(a=type.of(i)=="object"?i.millisecond||i.second||i.minute?t?VMM.Date.dateformats.time_no_seconds_short:VMM.Date.dateformats.time_no_seconds_small_date:i.hour?t?VMM.Date.dateformats.time_no_seconds_short:VMM.Date.dateformats.time_no_seconds_small_date:i.day?t?VMM.Date.dateformats.full_short:VMM.Date.dateformats.full:i.month?t?VMM.Date.dateformats.month_short:VMM.Date.dateformats.month:i.year?VMM.Date.dateformats.year:VMM.Date.dateformats.year:n.getMonth()===0&&n.getDate()==1&&n.getHours()===0&&n.getMinutes()===0?VMM.Date.dateformats.year:n.getDate()<=1&&n.getHours()===0&&n.getMinutes()===0?t?VMM.Date.dateformats.month_short:VMM.Date.dateformats.month:n.getHours()===0&&n.getMinutes()===0?t?VMM.Date.dateformats.full_short:VMM.Date.dateformats.full:n.getMinutes()===0?t?VMM.Date.dateformats.time_no_seconds_short:VMM.Date.dateformats.time_no_seconds_small_date:t?VMM.Date.dateformats.time_no_seconds_short:VMM.Date.dateformats.full_long,f=dateFormat(n,a,!1),u=f.split(" "),e=0;e<u.length;e++)parseInt(u[e],10)<0&&(trace("YEAR IS BC"),h=u[e],c=Math.abs(parseInt(u[e],10)),l=c.toString()+" B.C.",f=f.replace(h,l));if(v)for(s=dateFormat(r,a,!1),u=s.split(" "),o=0;o<u.length;o++)parseInt(u[o],10)<0&&(trace("YEAR IS BC"),h=u[o],c=Math.abs(parseInt(u[o],10)),l=c.toString()+" B.C.",s=s.replace(h,l))}else trace("NOT A VALID DATE?"),trace(n);return v?f+" &mdash; "+s:f}}.init(),dateFormat=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,i=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,r=/[^-+\dA-Z]/g,n=function(n,t){for(n=String(n),t=t||2;n.length<t;)n="0"+n;return n};return function(u,f,e){var h=dateFormat;arguments.length!=1||Object.prototype.toString.call(u)!="[object String]"||/\d/.test(u)||(f=u,u=undefined);isNaN(u)&&trace("invalid date "+u);f=String(h.masks[f]||f||h.masks["default"]);f.slice(0,4)=="UTC:"&&(f=f.slice(4),e=!0);var o=e?"getUTC":"get",c=u[o+"Date"](),y=u[o+"Day"](),l=u[o+"Month"](),p=u[o+"FullYear"](),s=u[o+"Hours"](),w=u[o+"Minutes"](),b=u[o+"Seconds"](),a=u[o+"Milliseconds"](),v=e?0:u.getTimezoneOffset(),k={d:c,dd:n(c),ddd:h.i18n.dayNames[y],dddd:h.i18n.dayNames[y+7],m:l+1,mm:n(l+1),mmm:h.i18n.monthNames[l],mmmm:h.i18n.monthNames[l+12],yy:String(p).slice(2),yyyy:p,h:s%12||12,hh:n(s%12||12),H:s,HH:n(s),M:w,MM:n(w),s:b,ss:n(b),l:n(a,3),L:n(a>99?Math.round(a/10):a),t:s<12?"a":"p",tt:s<12?"am":"pm",T:s<12?"A":"P",TT:s<12?"AM":"PM",Z:e?"UTC":(String(u).match(i)||[""]).pop().replace(r,""),o:(v>0?"-":"+")+n(Math.floor(Math.abs(v)/60)*100+Math.abs(v)%60,4),S:["th","st","nd","rd"][c%10>3?0:(c%100-c%10!=10)*c%10]};return f.replace(t,function(n){return n in k?k[n]:n.slice(1,n.length-1)})}}(),dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(n,t){return dateFormat(this,n,t)});typeof VMM!="undefined"&&typeof VMM.Util=="undefined"&&(VMM.Util={init:function(){return this},correctProtocol:function(n){var t=window.parent.location.protocol.toString(),i="",r=n.split("://",2);return i=t.match("http")?t:"https",i+"://"+r[1]},mergeConfig:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},getObjectAttributeByIndex:function(n,t){var i,r;if(typeof n!="undefined"){i=0;for(r in n){if(t===i)return n[r];i++}return""}return""},ordinal:function(n){return["th","st","nd","rd"][!(n%10>3||Math.floor(n%100/10)==1)*(n%10)]},randomBetween:function(n,t){return Math.floor(Math.random()*(t-n+1)+n)},average:function(n){for(var r={mean:0,variance:0,deviation:0},u=n.length,f,t=0,i=u;i--;t+=n[i]);for(f=r.mean=t/u,i=u,t=0;i--;t+=Math.pow(n[i]-f,2));return r.deviation=Math.sqrt(r.variance=t/u),r},customSort:function(n,t){var i=n,r=t;return i==r?0:i>r?1:-1},deDupeArray:function(n){for(var u=n.length,i=[],r={},t=0;t<u;t++)r[n[t]]=0;for(t in r)i.push(t);return i},number2money:function(n,t,i){var t=t!==null?t:!0,i=i!==null?i:!1,u=VMM.Math2.floatPrecision(n,2),r=this.niceNumber(u);return!r.split(/\./g)[1]&&i&&(r=r+".00"),t&&(r="$"+r),r},wordCount:function(n){var t=n+" ",r=t.replace(/^[^A-Za-z0-9\'\-]+/gi,""),u=r.replace(/[^A-Za-z0-9\'\-]+/gi," "),f=u.split(" "),i=f.length-1;return t.length<2&&(i=0),i},ratio:{fit:function(n,t,i,r){var u={width:0,height:0};return u.width=n,u.height=Math.round(n/i*r),u.height>t&&(u.height=t,u.width=Math.round(t/r*i),u.width>n&&trace("FIT: DIDN'T FIT!!! ")),u},r16_9:function(n,t){return n!==null&&n!==""?Math.round(t/16*9):t!==null&&t!==""?Math.round(n/9*16):void 0},r4_3:function(n,t){return n!==null&&n!==""?Math.round(t/4*3):t!==null&&t!==""?Math.round(n/3*4):void 0}},doubledigit:function(n){return(n<10?"0":"")+n},truncateWords:function(n,t,i){var r,s,f;t||(t=30);i||(i=t);var o=n.replace(/^[^A-Za-z0-9\'\-]+/gi,""),u=o.split(" "),e=[];for(t=Math.min(u.length,t),i=Math.min(u.length,i),r=0;r<t;r++)e.push(u[r]);for(s=t;r<i;r++)if(f=u[r],e.push(f),f.charAt(f.length-1)==".")break;return e.join(" ")},linkify:function(n){return n.replace(/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,"<a target='_blank' href='$&' onclick='void(0)'>$&<\/a>").replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,"$1<a target='_blank' onclick='void(0)' href='http://$2'>$2<\/a>").replace(/(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim,"<a target='_blank' onclick='void(0)' href='mailto:$1'>$1<\/a>")},linkify_with_twitter:function(n){return n.replace(/(\()((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\))|(\[)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\])|(\{)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\})|(<|&(?:lt|#60|#x3c);)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(>|&(?:gt|#62|#x3e);)|((?:^|[^=\s'"\]])\s*['"]?|[^=\s]\s+)(\b(?:ht|f)tps?:\/\/[a-z0-9\-._~!$'()*+,;=:\/?#[\]@%]+(?:(?!&(?:gt|#0*62|#x0*3e);|&(?:amp|apos|quot|#0*3[49]|#x0*2[27]);[.!&',:?;]?(?:[^a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]|$))&[a-z0-9\-._~!$'()*+,;=:\/?#[\]@%]*)*[a-z0-9\-_~$()*+=\/#[\]@%])/img,'$1$4$7$10$13<a href="$2$5$8$11$14" class="hyphenate">$2$5$8$11$14<\/a>$3$6$9$12').replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,"$1<a target='_blank' class='hyphenate' onclick='void(0)' href='http://$2'>$2<\/a>").replace(/(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim,"<a target='_blank' onclick='void(0)' href='mailto:$1'>$1<\/a>").replace(/\B@([\w-]+)/gm,"<a href='http://twitter.com/$1' target='_blank' onclick='void(0)'>@$1<\/a>")},linkify_wikipedia:function(n){return n.replace(/<i[^>]*>(.*?)<\/i>/gim,"<a target='_blank' href='http://en.wikipedia.org/wiki/$&' onclick='void(0)'>$&<\/a>").replace(/<i\b[^>]*>/gim,"").replace(/<\/i>/gim,"").replace(/<b\b[^>]*>/gim,"").replace(/<\/b>/gim,"")},unlinkify:function(n){return n?(n=n.replace(/<a\b[^>]*>/i,""),n.replace(/<\/a>/i,"")):n},untagify:function(n){return n?n.replace(/<\s*\w.*?>/g,""):n},nl2br:function(n){return n.replace(/(\r\n|[\r\n]|\\n|\\r)/g,"<br/>")},unique_ID:function(n){var t=function(n){return Math.floor(Math.random()*n)},i=function(){return"abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ".substr(t(62),1)},r=function(n){for(var t="",r=0;r<n;r++)t+=i();return t};return r(n)},isEven:function(n){return n%2==0?!0:!1},getUrlVars:function(n){var t=n.toString(),i,r,f,u;for(t.match("&#038;")?t=t.replace("&#038;","&"):t.match("&#38;")?t=t.replace("&#38;","&"):t.match("&amp;")&&(t=t.replace("&amp;","&")),i=[],f=t.slice(t.indexOf("?")+1).split("&"),u=0;u<f.length;u++)r=f[u].split("="),i.push(r[0]),i[r[0]]=r[1];return i},toHTML:function(n){return n=this.nl2br(n),n=this.linkify(n),n.replace(/\s\s/g,"&nbsp;&nbsp;")},toCamelCase:function(n,t){var i,r;for(t!==!1&&(t=!0),i=(t?n.toLowerCase():n).split(" "),r=0;r<i.length;r++)i[r]=i[r].substr(0,1).toUpperCase()+i[r].substr(1);return i.join(" ")},properQuotes:function(n){return n.replace(/\"([^\"]*)\"/gi,"&#8220;$1&#8221;")},niceNumber:function(n){n+="";x=n.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";for(var t=/(\d+)(\d{3})/;t.test(x1);)x1=x1.replace(t,"$1,$2");return x1+x2},toTitleCase:function(n){if(VMM.Browser.browser=="Explorer"&&parseInt(VMM.Browser.version,10)>=7)return n.replace("_","%20");var t={__smallWords:["a","an","and","as","at","but","by","en","for","if","in","of","on","or","the","to","v[.]?","via","vs[.]?"],init:function(){this.__smallRE=this.__smallWords.join("|");this.__lowerCaseWordsRE=new RegExp("\\b("+this.__smallRE+")\\b","gi");this.__firstWordRE=new RegExp("^([^a-zA-Z0-9 \\r\\n\\t]*)("+this.__smallRE+")\\b","gi");this.__lastWordRE=new RegExp("\\b("+this.__smallRE+")([^a-zA-Z0-9 \\r\\n\\t]*)$","gi")},toTitleCase:function(n){for(var t,i="",u=n.split(/([:.;?!][ ]|(?:[ ]|^)["“])/),r=0;r<u.length;++r)t=u[r],t=t.replace(/\b([a-zA-Z][a-z.'’]*)\b/g,this.__titleCaseDottedWordReplacer),t=t.replace(this.__lowerCaseWordsRE,this.__lowerReplacer),t=t.replace(this.__firstWordRE,this.__firstToUpperCase),t=t.replace(this.__lastWordRE,this.__firstToUpperCase),i+=t;return i=i.replace(/ V(s?)\. /g," v$1. "),i=i.replace(/(['’])S\b/g,"$1s"),i.replace(/\b(AT&T|Q&A)\b/ig,this.__upperReplacer)},__titleCaseDottedWordReplacer:function(n){return n.match(/[a-zA-Z][.][a-zA-Z]/)?n:t.__firstToUpperCase(n)},__lowerReplacer:function(n){return n.toLowerCase()},__upperReplacer:function(n){return n.toUpperCase()},__firstToUpperCase:function(n){var t=n.split(/(^[^a-zA-Z0-9]*[a-zA-Z0-9])(.*)$/);return t[1]&&(t[1]=t[1].toUpperCase()),t.join("")}};return t.init(),n=n.replace(/_/g," "),t.toTitleCase(n)}}.init());LazyLoad=function(n){function o(t,i){var u=n.createElement(t);for(var r in i)i.hasOwnProperty(r)&&u.setAttribute(r,i[r]);return u}function u(n){var t=i[n],u,e;t&&(u=t.callback,e=t.urls,e.shift(),r=0,e.length||(u&&u.call(t.context,t.obj),i[n]=null,f[n].length&&s(n)))}function a(){var i=navigator.userAgent;t={async:n.createElement("script").async===!0};(t.webkit=/AppleWebKit\//.test(i))||(t.ie=/MSIE/.test(i))||(t.opera=/Opera/.test(i))||(t.gecko=/Gecko\//.test(i))||(t.unknown=!0)}function s(r,s,h,v,y){var it=function(){u(r)},k=r==="css",g=[],p,b,w,nt,tt,d;if(t||a(),s)if(s=typeof s=="string"?[s]:s.concat(),k||t.async||t.gecko||t.opera)f[r].push({urls:s,callback:h,obj:v,context:y});else for(p=0,b=s.length;p<b;++p)f[r].push({urls:[s[p]],callback:p===b-1?h:null,obj:v,context:y});if(!i[r]&&(nt=i[r]=f[r].shift())){for(e||(e=n.head||n.getElementsByTagName("head")[0]),tt=nt.urls,p=0,b=tt.length;p<b;++p)d=tt[p],k?w=t.gecko?o("style"):o("link",{href:d,rel:"stylesheet"}):(w=o("script",{src:d}),w.async=!1),w.className="lazyload",w.setAttribute("charset","utf-8"),t.ie&&!k?w.onreadystatechange=function(){/loaded|complete/.test(w.readyState)&&(w.onreadystatechange=null,it())}:k&&(t.gecko||t.webkit)?t.webkit?(nt.urls[p]=w.href,l()):(w.innerHTML='@import "'+d+'";',c(w)):w.onload=w.onerror=it,g.push(w);for(p=0,b=g.length;p<b;++p)e.appendChild(g[p])}}function c(n){var t;try{t=!!n.sheet.cssRules}catch(i){r+=1;r<200?setTimeout(function(){c(n)},50):t&&u("css");return}u("css")}function l(){var n=i.css,t;if(n){for(t=h.length;--t>=0;)if(h[t].href===n.urls[0]){u("css");break}r+=1;n&&(r<200?setTimeout(l,50):u("css"))}}var t,e,i={},r=0,f={css:[],js:[]},h=n.styleSheets;return{css:function(n,t,i,r){s("css",n,t,i,r)},js:function(n,t,i,r){s("js",n,t,i,r)}}}(this.document);LoadLib=function(){function t(t){for(var i=0,r=!1,i=0;i<n.length;i++)n[i]==t&&(r=!0);return r?!0:(n.push(t),!1)}var n=[];return{css:function(n,i,r,u){t(n)||LazyLoad.css(n,i,r,u)},js:function(n,i,r,u){t(n)||LazyLoad.js(n,i,r,u)}}}(this.document);typeof VMM!="undefined"&&typeof VMM.Language=="undefined"&&(VMM.Language={lang:"en",api:{wikipedia:"en"},date:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],month_abbr:["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_abbr:["Sun.","Mon.","Tues.","Wed.","Thurs.","Fri.","Sat."]},dateformats:{year:"yyyy",month_short:"mmm",month:"mmmm yyyy",full_short:"mmm d",full:"mmmm d',' yyyy",time_no_seconds_short:"h:MM TT",time_no_seconds_small_date:"h:MM TT'<br/><small>'mmmm d',' yyyy'<\/small>'",full_long:"mmm d',' yyyy 'at' h:MM TT",full_long_small_date:"h:MM TT'<br/><small>mmm d',' yyyy'<\/small>'"},messages:{loading_timeline:"Loading Timeline... ",return_to_title:"Return to Title",expand_timeline:"Expand Timeline",contract_timeline:"Contract Timeline",wikipedia:"From Wikipedia, the free encyclopedia",loading_content:"Loading Content",loading:"Loading"}});typeof VMM!="undefined"&&typeof VMM.ExternalAPI=="undefined"&&(VMM.ExternalAPI={keys:{google:"",flickr:"",twitter:""},keys_master:{vp:"Pellentesque nibh felis, eleifend id, commodo in, interdum vitae, leo",flickr:"RAIvxHY4hE/Elm5cieh4X5ptMyDpj7MYIxziGxi0WGCcy1s+yr7rKQ==",google:"jwNGnYw4hE9lmAez4ll0QD+jo6SKBJFknkopLS4FrSAuGfIwyj57AusuR0s8dAo=",twitter:""},init:function(){return this},setKeys:function(n){VMM.ExternalAPI.keys=n},pushQues:function(){VMM.master_config.googlemaps.active&&VMM.ExternalAPI.googlemaps.pushQue();VMM.master_config.youtube.active&&VMM.ExternalAPI.youtube.pushQue();VMM.master_config.soundcloud.active&&VMM.ExternalAPI.soundcloud.pushQue();VMM.master_config.googledocs.active&&VMM.ExternalAPI.googledocs.pushQue();VMM.master_config.googleplus.active&&VMM.ExternalAPI.googleplus.pushQue();VMM.master_config.wikipedia.active&&VMM.ExternalAPI.wikipedia.pushQue();VMM.master_config.vimeo.active&&VMM.ExternalAPI.vimeo.pushQue();VMM.master_config.vine.active&&VMM.ExternalAPI.vine.pushQue();VMM.master_config.twitter.active&&VMM.ExternalAPI.twitter.pushQue();VMM.master_config.flickr.active&&VMM.ExternalAPI.flickr.pushQue();VMM.master_config.webthumb.active&&VMM.ExternalAPI.webthumb.pushQue()},twitter:{tweetArray:[],get:function(n){var t={mid:n.id,id:n.uid};VMM.master_config.twitter.que.push(t);VMM.master_config.twitter.active=!0},create:function(n,t){var i=n.mid.toString(),r={twitterid:n.mid},u="http://api.twitter.com/1/statuses/show.json?id="+n.mid+"&include_entities=true&callback=?";VMM.ExternalAPI.twitter.getOEmbed(n,t)},errorTimeOut:function(n){trace("TWITTER JSON ERROR TIMEOUT "+n.mid);VMM.attachElement("#"+n.id.toString(),VMM.MediaElement.loadingmessage("Still waiting on Twitter: "+n.mid));VMM.getJSON("http://api.twitter.com/1/account/rate_limit_status.json",function(t){trace("REMAINING TWITTER API CALLS "+t.remaining_hits);trace("TWITTER RATE LIMIT WILL RESET AT "+t.reset_time);var i="";i=t.remaining_hits==0?"<p>You've reached the maximum number of tweets you can load in an hour.<\/p>"+("<p>You can view tweets again starting at: <br/>"+t.reset_time+"<\/p>"):"<p>Still waiting on Twitter. "+n.mid+"<\/p>";VMM.attachElement("#"+n.id.toString(),VMM.MediaElement.loadingmessage(i))})},errorTimeOutOembed:function(n){trace("TWITTER JSON ERROR TIMEOUT "+n.mid);VMM.attachElement("#"+n.id.toString(),VMM.MediaElement.loadingmessage("Still waiting on Twitter: "+n.mid))},pushQue:function(){VMM.master_config.twitter.que.length>0&&(VMM.ExternalAPI.twitter.create(VMM.master_config.twitter.que[0],VMM.ExternalAPI.twitter.pushQue),VMM.master_config.twitter.que.remove(0))},getOEmbed:function(n,t){var r="http://api.twitter.com/1/statuses/oembed.json?id="+n.mid+"&omit_script=true&include_entities=true&callback=?",i=setTimeout(VMM.ExternalAPI.twitter.errorTimeOutOembed,VMM.master_config.timers.api,n);VMM.getJSON(r,function(t){var i="",r="";i+=t.html.split("<\/p>&mdash;")[0]+"<\/p><\/blockquote>";r=t.author_url.split("twitter.com/")[1];i+="<div class='vcard author'>";i+="<a class='screen-name url' href='"+t.author_url+"' target='_blank'>";i+="<span class='avatar'><\/span>";i+="<span class='fn'>"+t.author_name+"<\/span>";i+="<span class='nickname'>@"+r+"<span class='thumbnail-inline'><\/span><\/span>";i+="<\/a>";i+="<\/div>";VMM.attachElement("#"+n.id.toString(),i);VMM.attachElement("#text_thumb_"+n.id.toString(),t.html);VMM.attachElement("#marker_content_"+n.id.toString(),t.html)}).error(function(t,r){trace("TWITTER error");trace("TWITTER ERROR: "+r+" "+t.responseText);clearTimeout(i);VMM.attachElement("#"+n.id,VMM.MediaElement.loadingmessage("ERROR LOADING TWEET "+n.mid))}).success(function(){clearTimeout(i);clearTimeout(callback_timeout);t()})},getHTML:function(n){var t="http://api.twitter.com/1/statuses/oembed.json?id="+n+"&omit_script=true&include_entities=true&callback=?";VMM.getJSON(t,VMM.ExternalAPI.twitter.onJSONLoaded)},onJSONLoaded:function(n){trace("TWITTER JSON LOADED");var t=n.id;VMM.attachElement("#"+t,VMM.Util.linkify_with_twitter(n.html))},parseTwitterDate:function(n){return new Date(Date.parse(n))},prettyParseTwitterDate:function(n){var t=new Date(Date.parse(n));return VMM.Date.prettyDate(t,!0)},getTweets:function(n){for(var r,u,i=[],f=n.length,t=0;t<n.length;t++)r="",r=n[t].tweet.match("status/")?n[t].tweet.split("status/")[1]:n[t].tweet.match("statuses/")?n[t].tweet.split("statuses/")[1]:"",u="http://api.twitter.com/1/statuses/show.json?id="+r+"&include_entities=true&callback=?",VMM.getJSON(u,function(n){var r={},t="<div class='twitter'><blockquote><p>",e=VMM.Util.linkify_with_twitter(n.text,"_blank"),u;t+=e;t+="<\/p>";t+="— "+n.user.name+" (<a href='https://twitter.com/"+n.user.screen_name+"'>@"+n.user.screen_name+"<\/a>) <a href='https://twitter.com/"+n.user.screen_name+"/status/"+n.id+"'>"+VMM.ExternalAPI.twitter.prettyParseTwitterDate(n.created_at)+" <\/a><\/blockquote><\/div>";r.content=t;r.raw=n;i.push(r);i.length==f&&(u={tweetdata:i},VMM.fireEvent(global,"TWEETSLOADED",u))}).success(function(){trace("second success")}).error(function(){trace("error")}).complete(function(){trace("complete")})},getTweetSearch:function(n,t){var r=40,u,i;t!=null&&t!=""&&(r=t);u="http://search.twitter.com/search.json?q="+n+"&rpp="+r+"&include_entities=true&result_type=mixed";i=[];VMM.getJSON(u,function(n){for(var f,t=0;t<n.results.length;t++){var u={},r="<div class='twitter'><blockquote><p>",e=VMM.Util.linkify_with_twitter(n.results[t].text,"_blank");r+=e;r+="<\/p>";r+="— "+n.results[t].from_user_name+" (<a href='https://twitter.com/"+n.results[t].from_user+"'>@"+n.results[t].from_user+"<\/a>) <a href='https://twitter.com/"+n.results[t].from_user+"/status/"+n.id+"'>"+VMM.ExternalAPI.twitter.prettyParseTwitterDate(n.results[t].created_at)+" <\/a><\/blockquote><\/div>";u.content=r;u.raw=n.results[t];i.push(u)}f={tweetdata:i};VMM.fireEvent(global,"TWEETSLOADED",f)})},prettyHTML:function(n,t){var n=n.toString(),u={twitterid:n},i="http://api.twitter.com/1/statuses/show.json?id="+n+"&include_entities=true&callback=?",r=setTimeout(VMM.ExternalAPI.twitter.errorTimeOut,VMM.master_config.timers.api,n);VMM.getJSON(i,VMM.ExternalAPI.twitter.formatJSON).error(function(t,i){trace("TWITTER error");trace("TWITTER ERROR: "+i+" "+t.responseText);VMM.attachElement("#twitter_"+n,"<p>ERROR LOADING TWEET "+n+"<\/p>")}).success(function(n){clearTimeout(r);t&&VMM.ExternalAPI.twitter.secondaryMedia(n)})},formatJSON:function(n){var i=n.id_str,t="<blockquote><p>",r=VMM.Util.linkify_with_twitter(n.text,"_blank");t+=r;t+="<\/p><\/blockquote>";t+="<div class='vcard author'>";t+="<a class='screen-name url' href='https://twitter.com/"+n.user.screen_name+"' data-screen-name='"+n.user.screen_name+"' target='_blank'>";t+="<span class='avatar'><img src=' "+n.user.profile_image_url+"'  alt=''><\/span>";t+="<span class='fn'>"+n.user.name+"<\/span>";t+="<span class='nickname'>@"+n.user.screen_name+"<span class='thumbnail-inline'><\/span><\/span>";t+="<\/a>";t+="<\/div>";typeof n.entities.media!="undefined"&&n.entities.media[0].type=="photo"&&(t+="<img src=' "+n.entities.media[0].media_url+"'  alt=''>");VMM.attachElement("#twitter_"+i.toString(),t);VMM.attachElement("#text_thumb_"+i.toString(),n.text)}},googlemaps:{maptype:"toner",setMapType:function(n){n!=""&&(VMM.ExternalAPI.googlemaps.maptype=n)},get:function(n){var t,i;n.vars=VMM.Util.getUrlVars(n.id);t=VMM.ExternalAPI.keys.google!=""?VMM.ExternalAPI.keys.google:Aes.Ctr.decrypt(VMM.ExternalAPI.keys_master.google,VMM.ExternalAPI.keys_master.vp,256);i="http://maps.googleapis.com/maps/api/js?key="+t+"&v=3.9&libraries=places&sensor=false&callback=VMM.ExternalAPI.googlemaps.onMapAPIReady";VMM.master_config.googlemaps.active?VMM.master_config.googlemaps.que.push(n):(VMM.master_config.googlemaps.que.push(n),VMM.master_config.googlemaps.api_loaded||LoadLib.js(i,function(){trace("Google Maps API Library Loaded")}))},create:function(n){VMM.ExternalAPI.googlemaps.createAPIMap(n)},createiFrameMap:function(n){var i=n.id+"&output=embed",t="",r=n.uid.toString()+"_gmap";t+="<div class='google-map' id='"+r+"' style='width=100%;height=100%;'>";t+="<iframe width='100%' height='100%' frameborder='0' scrolling='no' marginheight='0' marginwidth='0' src='"+i+"'><\/iframe>";t+="<\/div>";VMM.attachElement("#"+n.uid,t)},createAPIMap:function(n){function v(n){if(n in VMM.ExternalAPI.googlemaps.map_providers)return h=VMM.ExternalAPI.googlemaps.map_attribution[VMM.ExternalAPI.googlemaps.map_providers[n].attribution],VMM.ExternalAPI.googlemaps.map_providers[n];if(VMM.ExternalAPI.googlemaps.defaultType(n))return trace("GOOGLE MAP DEFAULT TYPE"),google.maps.MapTypeId[n.toUpperCase()];trace("Not a maptype: "+n)}function y(){var s=new google.maps.Geocoder,e=VMM.Util.getUrlVars(n.id).q,h,o;e.match("loc:")&&(o=e.split(":")[1].split("+"),i=new google.maps.LatLng(parseFloat(o[0]),parseFloat(o[1])),r=!0);s.geocode({address:e},function(n,o){o==google.maps.GeocoderStatus.OK?(h=new google.maps.Marker({map:t,position:n[0].geometry.location}),typeof n[0].geometry.viewport!="undefined"?t.fitBounds(n[0].geometry.viewport):typeof n[0].geometry.bounds!="undefined"?t.fitBounds(n[0].geometry.bounds):t.setCenter(n[0].geometry.location),r&&t.panTo(i),f&&t.setZoom(u)):(trace("Geocode for "+e+" was not successful for the following reason: "+o),trace("TRYING PLACES SEARCH"),r&&t.panTo(i),f&&t.setZoom(u),p())})}function p(){function l(o,s){if(s==google.maps.places.PlacesServiceStatus.OK){for(var h=0;h<o.length;h++);r?t.panTo(i):o.length>=1&&(t.panTo(o[0].geometry.location),f&&t.setZoom(u))}else trace("Place search for "+e.query+" was not successful for the following reason: "+s),trace("YOU MAY NEED A GOOGLE MAPS API KEY IN ORDER TO USE THIS FEATURE OF TIMELINEJS"),trace("FIND OUT HOW TO GET YOUR KEY HERE: https://developers.google.com/places/documentation/#Authentication"),r?(t.panTo(i),f&&t.setZoom(u)):(trace("USING SIMPLE IFRAME MAP EMBED"),n.id[0].match("https")&&(n.id=n.url[0].replace("https","http")),VMM.ExternalAPI.googlemaps.createiFrameMap(n))}var e,o,c,s,h;place_search=new google.maps.places.PlacesService(t);o=new google.maps.InfoWindow;e={query:"",types:["country","neighborhood","political","locality","geocode"]};type.of(VMM.Util.getUrlVars(n.id).q)=="string"&&(e.query=VMM.Util.getUrlVars(n.id).q);r?(e.location=i,e.radius="15000"):(s=new google.maps.LatLng(-89.999999,-179.999999),h=new google.maps.LatLng(89.999999,179.999999),c=new google.maps.LatLngBounds(s,h));place_search.textSearch(e,l)}function w(){var o,e,s,h;o=n.id+"&output=kml";o=o.replace("&output=embed","");e=new google.maps.KmlLayer(o,{preserveViewport:!0});s=new google.maps.InfoWindow;e.setMap(t);google.maps.event.addListenerOnce(e,"defaultviewport_changed",function(){r?t.panTo(i):t.fitBounds(e.getDefaultViewport());f&&t.setZoom(u)});google.maps.event.addListener(e,"click",function(n){function i(n){s.setContent(n);s.open(t)}h=n.featureData.description;i(h)})}var h="",o,t,c,s=n.uid.toString()+"_gmap",l="",i=new google.maps.LatLng(41.875696,-87.624207),e,u=11,r=!1,f=!1,a=!1;google.maps.VeriteMapType=function(n){if(VMM.ExternalAPI.googlemaps.defaultType(n))return google.maps.MapTypeId[n.toUpperCase()];var t=v(n);return google.maps.ImageMapType.call(this,{getTileUrl:function(n,i){var r=(i+n.x+n.y)%VMM.ExternalAPI.googlemaps.map_subdomains.length;return[t.url.replace("{S}",VMM.ExternalAPI.googlemaps.map_subdomains[r]).replace("{Z}",i).replace("{X}",n.x).replace("{Y}",n.y).replace("{z}",i).replace("{x}",n.x).replace("{y}",n.y)]},tileSize:new google.maps.Size(256,256),name:n,minZoom:t.minZoom,maxZoom:t.maxZoom})};google.maps.VeriteMapType.prototype=new google.maps.ImageMapType("_");o=VMM.ExternalAPI.googlemaps.maptype!=""?VMM.ExternalAPI.googlemaps.defaultType(VMM.ExternalAPI.googlemaps.maptype)?google.maps.MapTypeId[VMM.ExternalAPI.googlemaps.maptype.toUpperCase()]:VMM.ExternalAPI.googlemaps.maptype:"toner";type.of(VMM.Util.getUrlVars(n.id).ll)=="string"?(r=!0,e=VMM.Util.getUrlVars(n.id).ll.split(","),i=new google.maps.LatLng(parseFloat(e[0]),parseFloat(e[1]))):type.of(VMM.Util.getUrlVars(n.id).sll)=="string"&&(e=VMM.Util.getUrlVars(n.id).sll.split(","),i=new google.maps.LatLng(parseFloat(e[0]),parseFloat(e[1])));type.of(VMM.Util.getUrlVars(n.id).z)=="string"&&(f=!0,u=parseFloat(VMM.Util.getUrlVars(n.id).z));c={zoom:u,draggable:!1,disableDefaultUI:!0,mapTypeControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.TOP_RIGHT},center:i,mapTypeId:o,mapTypeControlOptions:{mapTypeIds:[o]}};VMM.attachElement("#"+n.uid,"<div class='google-map' id='"+s+"' style='width=100%;height=100%;'><\/div>");t=new google.maps.Map(document.getElementById(s),c);VMM.ExternalAPI.googlemaps.defaultType(VMM.ExternalAPI.googlemaps.maptype)||(t.mapTypes.set(o,new google.maps.VeriteMapType(o)),l="<div class='map-attribution'><div class='attribution-text'>"+h+"<\/div><\/div>",VMM.appendElement("#"+s,l));type.of(VMM.Util.getUrlVars(n.id).msid)=="string"?w():type.of(VMM.Util.getUrlVars(n.id).q)=="string"&&y()},pushQue:function(){for(var n=0;n<VMM.master_config.googlemaps.que.length;n++)VMM.ExternalAPI.googlemaps.create(VMM.master_config.googlemaps.que[n]);VMM.master_config.googlemaps.que=[]},onMapAPIReady:function(){VMM.master_config.googlemaps.map_active=!0;VMM.master_config.googlemaps.places_active=!0;VMM.ExternalAPI.googlemaps.onAPIReady()},onPlacesAPIReady:function(){VMM.master_config.googlemaps.places_active=!0;VMM.ExternalAPI.googlemaps.onAPIReady()},onAPIReady:function(){VMM.master_config.googlemaps.active||VMM.master_config.googlemaps.map_active&&VMM.master_config.googlemaps.places_active&&(VMM.master_config.googlemaps.active=!0,VMM.ExternalAPI.googlemaps.pushQue())},defaultType:function(n){return n.toLowerCase()=="satellite"||n.toLowerCase()=="hybrid"||n.toLowerCase()=="terrain"||n.toLowerCase()=="roadmap"?!0:!1},map_subdomains:["","a.","b.","c.","d."],map_attribution:{stamen:"Map tiles by <a href='http://stamen.com'>Stamen Design<\/a>, under <a href='http://creativecommons.org/licenses/by/3.0'>CC BY 3.0<\/a>. Data by <a href='http://openstreetmap.org'>OpenStreetMap<\/a>, under <a href='http://creativecommons.org/licenses/by-sa/3.0'>CC BY SA<\/a>.",apple:"Map data &copy; 2012  Apple, Imagery &copy; 2012 Apple"},map_providers:{toner:{url:"http://{S}tile.stamen.com/toner/{Z}/{X}/{Y}.png",minZoom:0,maxZoom:20,attribution:"stamen"},"toner-lines":{url:"http://{S}tile.stamen.com/toner-lines/{Z}/{X}/{Y}.png",minZoom:0,maxZoom:20,attribution:"stamen"},"toner-labels":{url:"http://{S}tile.stamen.com/toner-labels/{Z}/{X}/{Y}.png",minZoom:0,maxZoom:20,attribution:"stamen"},sterrain:{url:"http://{S}tile.stamen.com/terrain/{Z}/{X}/{Y}.jpg",minZoom:4,maxZoom:20,attribution:"stamen"},apple:{url:"http://gsp2.apple.com/tile?api=1&style=slideshow&layers=default&lang=en_US&z={z}&x={x}&y={y}&v=9",minZoom:4,maxZoom:14,attribution:"apple"},watercolor:{url:"http://{S}tile.stamen.com/watercolor/{Z}/{X}/{Y}.jpg",minZoom:3,maxZoom:16,attribution:"stamen"}}},googleplus:{get:function(n){var t={user:n.user,activity:n.id,id:n.uid};VMM.master_config.googleplus.que.push(t);VMM.master_config.googleplus.active=!0},create:function(n,t){var r="",f="",e="",u="",i="",o,s;googleplus_timeout=setTimeout(VMM.ExternalAPI.googleplus.errorTimeOut,VMM.master_config.timers.api,n);callback_timeout=setTimeout(t,VMM.master_config.timers.api,n);f=VMM.master_config.Timeline.api_keys.google!=""?VMM.master_config.Timeline.api_keys.google:Aes.Ctr.decrypt(VMM.master_config.api_keys_master.google,VMM.master_config.vp,256);o="https://www.googleapis.com/plus/v1/people/"+n.user+"/activities/public?alt=json&maxResults=100&fields=items(id,url)&key="+f;r="GOOGLE PLUS API CALL";VMM.getJSON(o,function(t){for(var o=0;o<t.items.length;o++)if(trace("loop"),t.items[o].url.split("posts/")[1]==n.activity){trace("FOUND IT!!");e=t.items[o].id;s="https://www.googleapis.com/plus/v1/activities/"+e+"?alt=json&key="+f;VMM.getJSON(s,function(t){if(trace(t),typeof t.annotation!="undefined"?(u+="<div class='googleplus-annotation'>'"+t.annotation+"<\/div>",u+=t.object.content):u+=t.object.content,typeof t.object.attachments!="undefined"){for(var f=0;f<t.object.attachments.length;f++)t.object.attachments[f].objectType=="photo"?i="<a href='"+t.object.url+"' target='_blank'><img src='"+t.object.attachments[f].image.url+"' class='article-thumb'><\/a>"+i:t.object.attachments[f].objectType=="video"?(i="<img src='"+t.object.attachments[f].image.url+"' class='article-thumb'>"+i,i+="<div>",i+="<a href='"+t.object.attachments[f].url+"' target='_blank'>",i+="<h5>"+t.object.attachments[f].displayName+"<\/h5>",i+="<\/a>",i+="<\/div>"):t.object.attachments[f].objectType=="article"&&(i+="<div>",i+="<a href='"+t.object.attachments[f].url+"' target='_blank'>",i+="<h5>"+t.object.attachments[f].displayName+"<\/h5>",i+="<p>"+t.object.attachments[f].content+"<\/p>",i+="<\/a>",i+="<\/div>"),trace(t.object.attachments[f]);i="<div class='googleplus-attachments'>"+i+"<\/div>"}r="<div class='googleplus-content'>"+u+i+"<\/div>";r+="<div class='vcard author'><a class='screen-name url' href='"+t.url+"' target='_blank'>";r+="<span class='avatar'><img src='"+t.actor.image.url+"' style='max-width: 32px; max-height: 32px;'><\/span>";r+="<span class='fn'>"+t.actor.displayName+"<\/span>";r+="<span class='nickname'><span class='thumbnail-inline'><\/span><\/span>";r+="<\/a><\/div>";VMM.attachElement("#googleplus_"+n.activity,r)});break}}).error(function(t){var i=VMM.parseJSON(t.responseText);trace(i.error.message);VMM.attachElement("#googleplus_"+n.activity,VMM.MediaElement.loadingmessage("<p>ERROR LOADING GOOGLE+ <\/p><p>"+i.error.message+"<\/p>"))}).success(function(){clearTimeout(googleplus_timeout);clearTimeout(callback_timeout);t()})},pushQue:function(){VMM.master_config.googleplus.que.length>0&&(VMM.ExternalAPI.googleplus.create(VMM.master_config.googleplus.que[0],VMM.ExternalAPI.googleplus.pushQue),VMM.master_config.googleplus.que.remove(0))},errorTimeOut:function(n){trace("GOOGLE+ JSON ERROR TIMEOUT "+n.activity);VMM.attachElement("#googleplus_"+n.activity,VMM.MediaElement.loadingmessage("<p>Still waiting on GOOGLE+ <\/p><p>"+n.activity+"<\/p>"))}},googledocs:{get:function(n){VMM.master_config.googledocs.que.push(n);VMM.master_config.googledocs.active=!0},create:function(n){var t="";t=n.id.match(/docs.google.com/i)?"<iframe class='doc' frameborder='0' width='100%' height='100%' src='"+n.id+"&amp;embedded=true'><\/iframe>":"<iframe class='doc' frameborder='0' width='100%' height='100%' src='http://docs.google.com/viewer?url="+n.id+"&amp;embedded=true'><\/iframe>";VMM.attachElement("#"+n.uid,t)},pushQue:function(){for(var n=0;n<VMM.master_config.googledocs.que.length;n++)VMM.ExternalAPI.googledocs.create(VMM.master_config.googledocs.que[n]);VMM.master_config.googledocs.que=[]}},flickr:{get:function(n){VMM.master_config.flickr.que.push(n);VMM.master_config.flickr.active=!0},create:function(n,t){var i,u=setTimeout(t,VMM.master_config.timers.api,n),r;i=typeof VMM.master_config.Timeline!="undefined"&&VMM.master_config.Timeline.api_keys.flickr!=""?VMM.master_config.Timeline.api_keys.flickr:Aes.Ctr.decrypt(VMM.master_config.api_keys_master.flickr,VMM.master_config.vp,256);r="http://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key="+i+"&photo_id="+n.id+"&format=json&jsoncallback=?";VMM.getJSON(r,function(t){for(var h=t.sizes.size[0].url.split("photos/")[1].split("/")[1],o="#"+n.uid,s="#"+n.uid+"_thumb",r,u,f=!1,e="Large",e=VMM.ExternalAPI.flickr.sizes(VMM.master_config.sizes.api.height),i=0;i<t.sizes.size.length;i++)t.sizes.size[i].label==e&&(f=!0,r=t.sizes.size[i].source);f||(r=t.sizes.size[t.sizes.size.length-2].source);u=t.sizes.size[0].source;VMM.Lib.attr(o,"src",r);VMM.attachElement(s,"<img src='"+u+"'>")}).error(function(n,t){trace("FLICKR error");trace("FLICKR ERROR: "+t+" "+n.responseText)}).success(function(){clearTimeout(u);t()})},pushQue:function(){VMM.master_config.flickr.que.length>0&&(VMM.ExternalAPI.flickr.create(VMM.master_config.flickr.que[0],VMM.ExternalAPI.flickr.pushQue),VMM.master_config.flickr.que.remove(0))},sizes:function(n){return n<=75?"Thumbnail":n<=180?"Small":n<=240?"Small 320":n<=375?"Medium":n<=480?"Medium 640":n<=600?"Large":"Large"}},instagram:{get:function(n,t){return t?"http://instagr.am/p/"+n.id+"/media/?size=t":"http://instagr.am/p/"+n.id+"/media/?size="+VMM.ExternalAPI.instagram.sizes(VMM.master_config.sizes.api.height)},sizes:function(n){return n<=150?"t":n<=306?"m":"l"}},soundcloud:{get:function(n){VMM.master_config.soundcloud.que.push(n);VMM.master_config.soundcloud.active=!0},create:function(n,t){var i="http://soundcloud.com/oembed?url="+n.id+"&format=js&callback=?";VMM.getJSON(i,function(i){VMM.attachElement("#"+n.uid,i.html);t()})},pushQue:function(){VMM.master_config.soundcloud.que.length>0&&(VMM.ExternalAPI.soundcloud.create(VMM.master_config.soundcloud.que[0],VMM.ExternalAPI.soundcloud.pushQue),VMM.master_config.soundcloud.que.remove(0))}},wikipedia:{get:function(n){VMM.master_config.wikipedia.que.push(n);VMM.master_config.wikipedia.active=!0},create:function(n,t){var r="http://"+n.lang+".wikipedia.org/w/api.php?action=query&prop=extracts&redirects=&titles="+n.id+"&exintro=1&format=json&callback=?",i;callback_timeout=setTimeout(t,VMM.master_config.timers.api,n);VMM.Browser.browser=="Explorer"&&parseInt(VMM.Browser.version,10)>=7&&window.XDomainRequest&&(i="<h4><a href='http://"+VMM.master_config.language.api.wikipedia+".wikipedia.org/wiki/"+n.id+"' target='_blank'>"+n.url+"<\/a><\/h4>",i+="<span class='wiki-source'>"+VMM.master_config.language.messages.wikipedia+"<\/span>",i+="<p>Wikipedia entry unable to load using Internet Explorer 8 or below.<\/p>",VMM.attachElement("#"+n.uid,i));VMM.getJSON(r,function(t){var i;if(t.query){var r,e,f="",o="",u=[];for(r=VMM.Util.getObjectAttributeByIndex(t.query.pages,0).extract,e=VMM.Util.getObjectAttributeByIndex(t.query.pages,0).title,r.match("<p>")?u=r.split("<p>"):u.push(r),i=0;i<u.length;i++)i+1<=1&&i+1<u.length&&(o+="<p>"+u[i+1]);f="<h4><a href='http://"+VMM.master_config.language.api.wikipedia+".wikipedia.org/wiki/"+e+"' target='_blank'>"+e+"<\/a><\/h4>";f+="<span class='wiki-source'>"+VMM.master_config.language.messages.wikipedia+"<\/span>";f+=VMM.Util.linkify_wikipedia(o);r.match("REDIRECT")||VMM.attachElement("#"+n.uid,f)}}).error(function(i,r,u){trace("WIKIPEDIA error");trace("WIKIPEDIA ERROR: "+r+" "+i.responseText);trace(u);VMM.attachElement("#"+n.uid,VMM.MediaElement.loadingmessage("<p>Wikipedia is not responding<\/p>"));clearTimeout(callback_timeout);VMM.master_config.wikipedia.tries<4?(trace("WIKIPEDIA ATTEMPT "+VMM.master_config.wikipedia.tries),trace(n),VMM.master_config.wikipedia.tries++,VMM.ExternalAPI.wikipedia.create(n,t)):t()}).success(function(){VMM.master_config.wikipedia.tries=0;clearTimeout(callback_timeout);t()})},pushQue:function(){VMM.master_config.wikipedia.que.length>0&&(trace("WIKIPEDIA PUSH QUE "+VMM.master_config.wikipedia.que.length),VMM.ExternalAPI.wikipedia.create(VMM.master_config.wikipedia.que[0],VMM.ExternalAPI.wikipedia.pushQue),VMM.master_config.wikipedia.que.remove(0))}},youtube:{get:function(n){var t="http://gdata.youtube.com/feeds/api/videos/"+n.id+"?v=2&alt=jsonc&callback=?";VMM.master_config.youtube.que.push(n);VMM.master_config.youtube.active||VMM.master_config.youtube.api_loaded||LoadLib.js("http://www.youtube.com/player_api",function(){trace("YouTube API Library Loaded")});VMM.getJSON(t,function(t){VMM.ExternalAPI.youtube.createThumb(t,n)})},create:function(n){var t;if(typeof n.start!="undefined"){var i=n.start.toString(),r=0,u=0;i.match("m")?(r=parseInt(i.split("m")[0],10),u=parseInt(i.split("m")[1].split("s")[0],10),n.start=r*60+u):n.start=0}else n.start=0;t={active:!1,player:{},name:n.uid,playing:!1,hd:!1};typeof n.hd!="undefined"&&(t.hd=!0);t.player[n.id]=new YT.Player(n.uid,{height:"390",width:"640",playerVars:{enablejsapi:1,color:"white",showinfo:0,theme:"light",start:n.start,rel:0},videoId:n.id,events:{onReady:VMM.ExternalAPI.youtube.onPlayerReady,onStateChange:VMM.ExternalAPI.youtube.onStateChange}});VMM.master_config.youtube.array.push(t)},createThumb:function(n,t){if(trace("CREATE THUMB"),trace(n),trace(t),typeof n.data!="undefined"){var i="#"+t.uid+"_thumb";VMM.attachElement(i,"<img src='"+n.data.thumbnail.sqDefault+"'>")}},pushQue:function(){for(var n=0;n<VMM.master_config.youtube.que.length;n++)VMM.ExternalAPI.youtube.create(VMM.master_config.youtube.que[n]);VMM.master_config.youtube.que=[]},onAPIReady:function(){VMM.master_config.youtube.active=!0;VMM.ExternalAPI.youtube.pushQue()},stopPlayers:function(){for(var t,n=0;n<VMM.master_config.youtube.array.length;n++)VMM.master_config.youtube.array[n].playing&&(t=VMM.master_config.youtube.array[n].name,VMM.master_config.youtube.array[n].player[t].stopVideo())},onStateChange:function(n){for(var i,t=0;t<VMM.master_config.youtube.array.length;t++)i=VMM.master_config.youtube.array[t].name,VMM.master_config.youtube.array[t].player[i]==n.target&&n.data==YT.PlayerState.PLAYING&&(VMM.master_config.youtube.array[t].playing=!0,trace(VMM.master_config.youtube.array[t].hd),VMM.master_config.youtube.array[t].hd)},onPlayerReady:function(){}},vimeo:{get:function(n){VMM.master_config.vimeo.que.push(n);VMM.master_config.vimeo.active=!0},create:function(n,t){trace("VIMEO CREATE");var i="http://vimeo.com/api/v2/video/"+n.id+".json",r="http://player.vimeo.com/video/"+n.id+"?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff";VMM.getJSON(i,function(i){VMM.ExternalAPI.vimeo.createThumb(i,n);t()});VMM.attachElement("#"+n.uid,"<iframe autostart='false' frameborder='0' width='100%' height='100%' src='"+r+"'><\/iframe>")},createThumb:function(n,t){trace("VIMEO CREATE THUMB");var i="#"+t.uid+"_thumb";VMM.attachElement(i,"<img src='"+n[0].thumbnail_small+"'>")},pushQue:function(){VMM.master_config.vimeo.que.length>0&&(VMM.ExternalAPI.vimeo.create(VMM.master_config.vimeo.que[0],VMM.ExternalAPI.vimeo.pushQue),VMM.master_config.vimeo.que.remove(0))}},vine:{get:function(n){VMM.master_config.vine.que.push(n);VMM.master_config.vine.active=!0},create:function(n){trace("VINE CREATE");var t="https://vine.co/v/"+n.id+"/embed/simple";VMM.attachElement("#"+n.uid,"<iframe frameborder='0' width='100%' height='100%' src='"+t+"'><\/iframe><script async src='http://platform.vine.co/static/scripts/embed.js' charset='utf-8'><\/script>")},pushQue:function(){VMM.master_config.vine.que.length>0&&(VMM.ExternalAPI.vine.create(VMM.master_config.vine.que[0],VMM.ExternalAPI.vine.pushQue),VMM.master_config.vine.que.remove(0))}},webthumb:{get:function(n){VMM.master_config.webthumb.que.push(n);VMM.master_config.webthumb.active=!0},sizes:function(n){return n<=150?"t":n<=306?"m":"l"},create:function(n){trace("WEB THUMB CREATE");var t="http://free.pagepeeker.com/v2/thumbs.php?";url=n.id.replace("http://","");VMM.attachElement("#"+n.uid,"<a href='"+n.id+"' target='_blank'><img src='"+t+"size=x&url="+url+"'><\/a>");VMM.attachElement("#"+n.uid+"_thumb","<img src='"+t+"size=t&url="+url+"'>")},pushQue:function(){for(var n=0;n<VMM.master_config.webthumb.que.length;n++)VMM.ExternalAPI.webthumb.create(VMM.master_config.webthumb.que[n]);VMM.master_config.webthumb.que=[]}}}.init());typeof VMM!="undefined"&&typeof VMM.MediaElement=="undefined"&&(VMM.MediaElement={init:function(){return this},loadingmessage:function(n){return"<div class='vco-loading'><div class='vco-loading-container'><div class='vco-loading-icon'><\/div><div class='vco-message'><p>"+n+"<\/p><\/div><\/div><\/div>"},thumbnail:function(n,t,i,r){var f=16,e=24,o="";if(t!=null&&t!=""&&(f=t),i!=null&&i!=""&&(e=i),r!=null&&r!=""&&(o=r),n.media!=null&&n.media!=""){var u=VMM.MediaType(n.media);return n.thumbnail!=null&&n.thumbnail!=""?(trace("CUSTOM THUMB"),"<div class='thumbnail thumb-custom' id='"+r+"_custom_thumb'><img src='"+n.thumbnail+"'><\/div>"):u.type=="image"?"<div class='thumbnail thumb-photo'><\/div>":u.type=="flickr"?"<div class='thumbnail thumb-photo' id='"+r+"_thumb'><\/div>":u.type=="instagram"?"<div class='thumbnail thumb-instagram' id='"+r+"_thumb'><img src='"+VMM.ExternalAPI.instagram.get(u.id,!0)+"'><\/div>":u.type=="youtube"?"<div class='thumbnail thumb-youtube' id='"+r+"_thumb'><\/div>":u.type=="googledoc"?"<div class='thumbnail thumb-document'><\/div>":u.type=="vimeo"?"<div class='thumbnail thumb-vimeo' id='"+r+"_thumb'><\/div>":u.type=="vine"?"<div class='thumbnail thumb-vine'><\/div>":u.type=="dailymotion"?"<div class='thumbnail thumb-video'><\/div>":u.type=="twitter"?"<div class='thumbnail thumb-twitter'><\/div>":u.type=="twitter-ready"?"<div class='thumbnail thumb-twitter'><\/div>":u.type=="soundcloud"?"<div class='thumbnail thumb-audio'><\/div>":u.type=="google-map"?"<div class='thumbnail thumb-map'><\/div>":u.type=="googleplus"?"<div class='thumbnail thumb-googleplus'><\/div>":u.type=="wikipedia"?"<div class='thumbnail thumb-wikipedia'><\/div>":u.type=="storify"?"<div class='thumbnail thumb-storify'><\/div>":u.type=="quote"?"<div class='thumbnail thumb-quote'><\/div>":u.type=="iframe"?"<div class='thumbnail thumb-video'><\/div>":u.type=="unknown"?u.id.match("blockquote")?"<div class='thumbnail thumb-quote'><\/div>":"<div class='thumbnail thumb-plaintext'><\/div>":u.type=="website"?"<div class='thumbnail thumb-website' id='"+r+"_thumb'><\/div>":"<div class='thumbnail thumb-plaintext'><\/div>"}},create:function(n,t){var h=!1,u=VMM.MediaElement.loadingmessage(VMM.master_config.language.messages.loading+"...");if(n.media!=null&&n.media!=""){var r="",e="",o="",s="",f=!1,i;return i=VMM.MediaType(n.media),i.uid=t,h=!0,n.credit!=null&&n.credit!=""&&(o="<div class='credit'>"+VMM.Util.linkify_with_twitter(n.credit,"_blank")+"<\/div>"),n.caption!=null&&n.caption!=""&&(e="<div class='caption'>"+VMM.Util.linkify_with_twitter(n.caption,"_blank")+"<\/div>"),i.type=="image"?(i.id.match("https://")&&(i.id=i.id.replace("https://","http://")),r="<div class='media-image media-shadow'><img src='"+i.id+"' class='media-image'><\/div>"):i.type=="flickr"?(r="<div class='media-image media-shadow'><a href='"+i.link+"' target='_blank'><img id='"+t+"'><\/a><\/div>",VMM.ExternalAPI.flickr.get(i)):i.type=="instagram"?r="<div class='media-image media-shadow'><a href='"+i.link+"' target='_blank'><img src='"+VMM.ExternalAPI.instagram.get(i)+"'><\/a><\/div>":i.type=="googledoc"?(r="<div class='media-frame media-shadow doc' id='"+i.uid+"'>"+u+"<\/div>",VMM.ExternalAPI.googledocs.get(i)):i.type=="youtube"?(r="<div class='media-shadow'><div class='media-frame video youtube' id='"+i.uid+"'>"+u+"<\/div><\/div>",VMM.ExternalAPI.youtube.get(i)):i.type=="vimeo"?(r="<div class='media-shadow media-frame video vimeo' id='"+i.uid+"'>"+u+"<\/div>",VMM.ExternalAPI.vimeo.get(i)):i.type=="dailymotion"?r="<div class='media-shadow'><iframe class='media-frame video dailymotion' autostart='false' frameborder='0' width='100%' height='100%' src='http://www.dailymotion.com/embed/video/"+i.id+"'><\/iframe><\/div>":i.type=="vine"?(r="<div class='media-shadow media-frame video vine' id='"+i.uid+"'>"+u+"<\/div>",VMM.ExternalAPI.vine.get(i)):i.type=="twitter"?(r="<div class='twitter' id='"+i.uid+"'>"+u+"<\/div>",f=!0,VMM.ExternalAPI.twitter.get(i)):i.type=="twitter-ready"?(f=!0,r=i.id):i.type=="soundcloud"?(r="<div class='media-frame media-shadow soundcloud' id='"+i.uid+"'>"+u+"<\/div>",VMM.ExternalAPI.soundcloud.get(i)):i.type=="google-map"?(r="<div class='media-frame media-shadow map' id='"+i.uid+"'>"+u+"<\/div>",VMM.ExternalAPI.googlemaps.get(i)):i.type=="googleplus"?(s="googleplus_"+i.id,r="<div class='googleplus' id='"+s+"'>"+u+"<\/div>",f=!0,VMM.ExternalAPI.googleplus.get(i)):i.type=="wikipedia"?(r="<div class='wikipedia' id='"+i.uid+"'>"+u+"<\/div>",f=!0,VMM.ExternalAPI.wikipedia.get(i)):i.type=="storify"?(f=!0,r="<div class='plain-text-quote'>"+i.id+"<\/div>"):i.type=="iframe"?(f=!0,r="<div class='media-shadow'><iframe class='media-frame video' autostart='false' frameborder='0' width='100%' height='100%' src='"+i.id+"'><\/iframe><\/div>"):i.type=="quote"?(f=!0,r="<div class='plain-text-quote'>"+i.id+"<\/div>"):i.type=="unknown"?(trace("NO KNOWN MEDIA TYPE FOUND TRYING TO JUST PLACE THE HTML"),f=!0,r="<div class='plain-text'><div class='container'>"+VMM.Util.properQuotes(i.id)+"<\/div><\/div>"):i.type=="website"?(r="<div class='media-shadow website' id='"+i.uid+"'>"+u+"<\/div>",VMM.ExternalAPI.webthumb.get(i)):(trace("NO KNOWN MEDIA TYPE FOUND"),trace(i.type)),r="<div class='media-container' >"+r+o+e+"<\/div>",f?"<div class='text-media'><div class='media-wrapper'>"+r+"<\/div><\/div>":"<div class='media-wrapper'>"+r+"<\/div>"}}}.init());typeof VMM!="undefined"&&typeof VMM.MediaType=="undefined"&&(VMM.MediaType=function(n){var t=n.replace(/^\s\s*/,"").replace(/\s\s*$/,""),r=!1,i={type:"unknown",id:"",start:0,hd:!1,link:"",lang:VMM.Language.lang,uniqueid:VMM.Util.unique_ID(6)},u;return(t.match("div class='twitter'")?(i.type="twitter-ready",i.id=t,r=!0):t.match("(www.)?youtube|youtu.be")?(t.match("v=")?i.id=VMM.Util.getUrlVars(t).v:t.match("/embed/")?i.id=t.split("embed/")[1].split(/[?&]/)[0]:t.match(/v\/|v=|youtu\.be\//)?i.id=t.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0]:trace("YOUTUBE IN URL BUT NOT A VALID VIDEO"),i.start=VMM.Util.getUrlVars(t).t,i.hd=VMM.Util.getUrlVars(t).hd,i.type="youtube",r=!0):t.match("(player.)?vimeo.com")?(i.type="vimeo",i.id=t.split(/video\/|\/\/vimeo\.com\//)[1].split(/[?&]/)[0],r=!0):t.match("(www.)?dailymotion.com")?(i.id=t.split(/video\/|\/\/dailymotion\.com\//)[1],i.type="dailymotion",r=!0):t.match("(www.)?vine.co")?(trace("VINE"),t.match("vine.co/v/")&&(i.id=t.split("vine.co/v/")[1],trace(i.id)),trace(t),i.type="vine",r=!0):t.match("(player.)?soundcloud.com")?(i.type="soundcloud",i.id=t,r=!0):t.match("(www.)?twitter.com")&&t.match("status")?(i.id=t.match("status/")?t.split("status/")[1]:t.match("statuses/")?t.split("statuses/")[1]:"",i.type="twitter",r=!0):t.match("maps.google")&&!t.match("staticmap")?(i.type="google-map",i.id=t.split(/src=['|"][^'|"]*?['|"]/gi),r=!0):t.match("plus.google")?(i.type="googleplus",i.id=t.split("/posts/")[1],i.user=t.split("/posts/")[0].match("u/0/")?t.split("u/0/")[1].split("/posts")[0]:t.split("google.com/")[1].split("/posts/")[0],r=!0):t.match("flickr.com/photos")?(i.type="flickr",i.id=t.split("photos/")[1].split("/")[1],i.link=t,r=!0):t.match("instagr.am/p/")?(i.type="instagram",i.link=t,i.id=t.split("/p/")[1].split("/")[0],r=!0):t.match(/jpg|jpeg|png|gif/i)||t.match("staticmap")||t.match("yfrog.com")||t.match("twitpic.com")?(i.type="image",i.id=t,r=!0):VMM.FileExtention.googleDocType(t)?(i.type="googledoc",i.id=t,r=!0):t.match("(www.)?wikipedia.org")?(i.type="wikipedia",u=t.split("wiki/")[1].split("#")[0].replace("_"," "),i.id=u.replace(" ","%20"),i.lang=t.split("//")[1].split(".wikipedia")[0],r=!0):t.indexOf("http://")==0?(i.type="website",i.id=t,r=!0):t.match("storify")?(i.type="storify",i.id=t,r=!0):t.match("blockquote")?(i.type="quote",i.id=t,r=!0):t.match("iframe")?(i.type="iframe",trace("IFRAME"),trace(t.match(/src\=([^\s]*)\s/)[1].split(/"/)[1]),i.id=t.match(/src\=([^\s]*)\s/)[1].split(/"/)[1],r=!0):(trace("unknown media"),i.type="unknown",i.id=t,r=!0),r)?i:(trace("No valid media id detected"),trace(t),!1)});typeof VMM!="undefined"&&typeof VMM.TextElement=="undefined"&&(VMM.TextElement={init:function(){return this},create:function(n){return n}}.init());typeof VMM!="undefined"&&typeof VMM.DragSlider=="undefined"&&(VMM.DragSlider=function(){function h(n,i){VMM.bindEvent(n,l,t.down,{element:i,delement:n});VMM.bindEvent(n,a,t.up,{element:i,delement:n});VMM.bindEvent(n,c,t.leave,{element:i,delement:n})}function c(r){return VMM.unbindEvent(r.data.delement,i,t.move),n.touch||r.preventDefault(),r.stopPropagation(),n.sliding?(n.sliding=!1,u(r.data.element,r.data.delement,r),!1):!0}function l(t){return v(t.data.element,t.data.delement,t),n.touch||t.preventDefault(),!0}function a(t){return n.touch||t.preventDefault(),n.sliding?(n.sliding=!1,u(t.data.element,t.data.delement,t),!1):!0}function i(n){y(n.data.element,n)}function v(r,u,e){n.touch?(trace("IS TOUCH"),VMM.Lib.css(r,"-webkit-transition-duration","0"),n.pagex.start=e.originalEvent.touches[0].screenX,n.pagey.start=e.originalEvent.touches[0].screenY):(n.pagex.start=e.pageX,n.pagey.start=e.pageY);n.left.start=f(r);n.time.start=(new Date).getTime();VMM.Lib.stop(r);VMM.bindEvent(u,i,t.move,{element:r})}function u(n,r,u){VMM.unbindEvent(r,i,t.move);p(n,u)}function y(t,i){var r;n.sliding=!0;n.touch?(n.pagex.end=i.originalEvent.touches[0].screenX,n.pagey.end=i.originalEvent.touches[0].screenY):(n.pagex.end=i.pageX,n.pagey.end=i.pageY);n.left.end=f(t);r=-(n.pagex.start-n.pagex.end-n.left.start);Math.abs(n.pagey.start)-Math.abs(n.pagey.end)>10&&(trace("SCROLLING Y"),trace(Math.abs(n.pagey.start)-Math.abs(n.pagey.end)));Math.abs(r-n.left.start)>10&&(VMM.Lib.css(t,"left",r),i.preventDefault(),i.stopPropagation())}function p(t){var i={left:n.left.end,left_adjust:0,change:{x:0},time:((new Date).getTime()-n.time.start)*10,time_adjust:((new Date).getTime()-n.time.start)*10},u=3e3;n.touch&&(u=6e3);i.change.x=u*(Math.abs(n.pagex.end)-Math.abs(n.pagex.start));i.left_adjust=Math.round(i.change.x/i.time);i.left=Math.min(i.left+i.left_adjust);n.constraint&&(i.left>n.constraint.left?(i.left=n.constraint.left,i.time>5e3&&(i.time=5e3)):i.left<n.constraint.right&&(i.left=n.constraint.right,i.time>5e3&&(i.time=5e3)));VMM.fireEvent(s,"DRAGUPDATE",[i]);r||i.time>0&&(n.touch?VMM.Lib.animate(t,i.time,"easeOutCirc",{left:i.left}):VMM.Lib.animate(t,i.time,n.ease,{left:i.left}))}function f(n){return parseInt(VMM.Lib.css(n,"left").substring(0,VMM.Lib.css(n,"left").length-2),10)}var n={element:"",element_move:"",constraint:"",sliding:!1,pagex:{start:0,end:0},pagey:{start:0,end:0},left:{start:0,end:0},time:{start:0,end:0},touch:!1,ease:"easeOutExpo"},t={down:"mousedown",up:"mouseup",leave:"mouseleave",move:"mousemove"},e={down:"mousedown",up:"mouseup",leave:"mouseleave",move:"mousemove"},o={down:"touchstart",up:"touchend",leave:"mouseleave",move:"touchmove"},s=this,r=!1;this.createPanel=function(i,u,f,s,c){n.element=i;n.element_move=u;c!=null&&c!=""&&(r=c);n.constraint=f!=null&&f!=""?f:!1;n.touch=s?s:!1;trace("TOUCH"+n.touch);t=n.touch?o:e;h(n.element,n.element_move)};this.updateConstraint=function(t){trace("updateConstraint");n.constraint=t};this.cancelSlide=function(){return VMM.unbindEvent(n.element,i,t.move),!0}});typeof VMM!="undefined"&&typeof VMM.Slider=="undefined"&&(VMM.Slider=function(n,t){function w(n,t){var o=!0,s=!1;n!=null&&(o=n);t!=null&&(s=t);a=i.slider.width;i.slider.nav.height=VMM.Lib.height(u.prevBtnContainer);i.slider.content.padding=VMM.Browser.device=="mobile"||a<=640?10:i.slider.content.padding_default;i.slider.content.width=a-i.slider.content.padding*2;VMM.Lib.width(p,r.length*i.slider.content.width);s&&VMM.Lib.css(e,"left",r[f].leftpos());ut();lt();VMM.Lib.css(u.nextBtn,"left",a-i.slider.nav.width);VMM.Lib.height(u.prevBtn,i.slider.height);VMM.Lib.height(u.nextBtn,i.slider.height);VMM.Lib.css(u.nextBtnContainer,"top",i.slider.height/2-i.slider.nav.height/2+10);VMM.Lib.css(u.prevBtnContainer,"top",i.slider.height/2-i.slider.nav.height/2+10);VMM.Lib.height(y,i.slider.height);VMM.Lib.width(y,a);o&&c(f,"linear",1);f==0&&VMM.Lib.visible(u.prevBtn,!1)}function ot(n,t){trace("DRAG FINISH");trace(t.left_adjust);trace(i.slider.width/2);t.left_adjust<0?Math.abs(t.left_adjust)>i.slider.width/2?f==r.length-1?v():(c(f+1,"easeOutExpo"),b()):v():Math.abs(t.left_adjust)>i.slider.width/2?f==0?v():(c(f-1,"easeOutExpo"),b()):v()}function nt(){f==r.length-1?v():(c(f+1),b())}function tt(){f==0?v():(c(f-1),b())}function st(n){switch(n.keyCode){case 39:nt(n);break;case 37:tt(n)}}function it(){ft()}function b(){i.current_slide=f;VMM.fireEvent(s,"UPDATE")}function ht(n){var t=0,i;for(VMM.attachElement(p,""),r=[],t=0;t<n.length;t++)i=new VMM.Slider.Slide(n[t],p),r.push(i)}function ct(n){var t=0;if(n)rt();else{for(t=0;t<r.length;t++)r[t].clearTimers();et=setTimeout(rt,i.duration)}}function rt(){for(var n=0,n=0;n<r.length;n++)r[n].enqueue=!0;for(n=0;n<i.preload;n++)f+n>r.length-1||(r[f+n].show(),r[f+n].enqueue=!1),f-n<0||(r[f-n].show(),r[f-n].enqueue=!1);if(r.length>50)for(n=0;n<r.length;n++)r[n].enqueue&&r[n].hide();ut()}function ut(){var f=0,u=".slider-item .layout-text-media .media .media-container ",t=".slider-item .layout-media .media .media-container ",o=".slider-item .media .media-container",e=!1,n={text_media:{width:i.slider.content.width/100*60,height:i.slider.height-60,video:{width:0,height:0},text:{width:i.slider.content.width/100*40-30,height:i.slider.height}},media:{width:i.slider.content.width,height:i.slider.height-110,video:{width:0,height:0}}};for((VMM.Browser.device=="mobile"||a<641)&&(e=!0),VMM.master_config.sizes.api.width=n.media.width,VMM.master_config.sizes.api.height=n.media.height,n.text_media.video=VMM.Util.ratio.fit(n.text_media.width,n.text_media.height,16,9),n.media.video=VMM.Util.ratio.fit(n.media.width,n.media.height,16,9),VMM.Lib.css(".slider-item","width",i.slider.content.width),VMM.Lib.height(".slider-item",i.slider.height),e?(n.text_media.width=i.slider.content.width-i.slider.content.padding*2,n.media.width=i.slider.content.width-i.slider.content.padding*2,n.text_media.height=i.slider.height/2-50,n.media.height=i.slider.height/100*70-40,n.text_media.video=VMM.Util.ratio.fit(n.text_media.width,n.text_media.height,16,9),n.media.video=VMM.Util.ratio.fit(n.media.width,n.media.height,16,9),VMM.Lib.css(".slider-item .layout-text-media .text","width","100%"),VMM.Lib.css(".slider-item .layout-text-media .text","display","block"),VMM.Lib.css(".slider-item .layout-text-media .text .container","display","block"),VMM.Lib.css(".slider-item .layout-text-media .text .container","width",n.media.width),VMM.Lib.css(".slider-item .layout-text-media .text .container .start","width","auto"),VMM.Lib.css(".slider-item .layout-text-media .media","float","none"),VMM.Lib.addClass(".slider-item .content-container","pad-top"),VMM.Lib.css(".slider-item .media blockquote p","line-height","18px"),VMM.Lib.css(".slider-item .media blockquote p","font-size","16px"),VMM.Lib.css(".slider-item","overflow-y","auto")):(VMM.Lib.css(".slider-item .layout-text-media .text","width","40%"),VMM.Lib.css(".slider-item .layout-text-media .text","display","table-cell"),VMM.Lib.css(".slider-item .layout-text-media .text .container","display","table-cell"),VMM.Lib.css(".slider-item .layout-text-media .text .container","width","auto"),VMM.Lib.css(".slider-item .layout-text-media .text .container .start","width",n.text_media.text.width),VMM.Lib.removeClass(".slider-item .content-container","pad-top"),VMM.Lib.css(".slider-item .layout-text-media .media","float","left"),VMM.Lib.css(".slider-item .layout-text-media","display","table"),VMM.Lib.css(".slider-item .media blockquote p","line-height","36px"),VMM.Lib.css(".slider-item .media blockquote p","font-size","28px"),VMM.Lib.css(".slider-item","display","table"),VMM.Lib.css(".slider-item","overflow-y","auto")),VMM.Lib.css(u+".media-frame","max-width",n.text_media.width),VMM.Lib.height(u+".media-frame",n.text_media.height),VMM.Lib.width(u+".media-frame",n.text_media.width),VMM.Lib.css(u+"img","max-height",n.text_media.height),VMM.Lib.css(t+"img","max-height",n.media.height),VMM.Lib.css(u+"img","max-width",n.text_media.width),VMM.Lib.css(u+".avatar img","max-width",32),VMM.Lib.css(u+".avatar img","max-height",32),VMM.Lib.css(t+".avatar img","max-width",32),VMM.Lib.css(t+".avatar img","max-height",32),VMM.Lib.css(u+".article-thumb","max-width","50%"),VMM.Lib.css(t+".article-thumb","max-width",200),VMM.Lib.width(u+".media-frame",n.text_media.video.width),VMM.Lib.height(u+".media-frame",n.text_media.video.height),VMM.Lib.width(t+".media-frame",n.media.video.width),VMM.Lib.height(t+".media-frame",n.media.video.height),VMM.Lib.css(t+".media-frame","max-height",n.media.video.height),VMM.Lib.css(t+".media-frame","max-width",n.media.video.width),VMM.Lib.height(t+".soundcloud",168),VMM.Lib.height(u+".soundcloud",168),VMM.Lib.width(t+".soundcloud",n.media.width),VMM.Lib.width(u+".soundcloud",n.text_media.width),VMM.Lib.css(o+".soundcloud","max-height",168),VMM.Lib.height(u+".map",n.text_media.height),VMM.Lib.width(u+".map",n.text_media.width),VMM.Lib.css(t+".map","max-height",n.media.height),VMM.Lib.width(t+".map",n.media.width),VMM.Lib.height(u+".doc",n.text_media.height),VMM.Lib.width(u+".doc",n.text_media.width),VMM.Lib.height(t+".doc",n.media.height),VMM.Lib.width(t+".doc",n.media.width),VMM.Lib.width(t+".wikipedia",n.media.width),VMM.Lib.width(t+".twitter",n.media.width),VMM.Lib.width(t+".plain-text-quote",n.media.width),VMM.Lib.width(t+".plain-text",n.media.width),VMM.Lib.css(o,"max-width",n.media.width),VMM.Lib.css(u+".caption","max-width",n.text_media.video.width),VMM.Lib.css(t+".caption","max-width",n.media.video.width),f=0;f<r.length;f++)r[f].layout(e),r[f].content_height()>i.slider.height+20?r[f].css("display","block"):r[f].css("display","table")}function lt(){for(var t=0,n=0,n=0;n<r.length;n++)t=n*(i.slider.width+i.spacing),r[n].leftpos(t)}function c(n,t,h,c,a){var p=i.ease,w=i.duration,k=!1,d=!1,v="",b,y;if(VMM.ExternalAPI.youtube.stopPlayers(),f=n,b=r[f].leftpos(),f==0&&(d=!0),f+1>=r.length&&(k=!0),t!=null&&t!=""&&(p=t),h!=null&&h!=""&&(w=h),VMM.Browser.device=="mobile"?(VMM.Lib.visible(u.prevBtn,!1),VMM.Lib.visible(u.nextBtn,!1)):(d?VMM.Lib.visible(u.prevBtn,!1):(VMM.Lib.visible(u.prevBtn,!0),v=VMM.Util.unlinkify(o[f-1].title),i.type=="timeline"?typeof o[f-1].date=="undefined"?(VMM.attachElement(u.prevDate,v),VMM.attachElement(u.prevTitle,"")):(VMM.attachElement(u.prevDate,VMM.Date.prettyDate(o[f-1].startdate,!1,o[f-1].precisiondate)),VMM.attachElement(u.prevTitle,v)):VMM.attachElement(u.prevTitle,v)),k?VMM.Lib.visible(u.nextBtn,!1):(VMM.Lib.visible(u.nextBtn,!0),v=VMM.Util.unlinkify(o[f+1].title),i.type=="timeline"?typeof o[f+1].date=="undefined"?(VMM.attachElement(u.nextDate,v),VMM.attachElement(u.nextTitle,"")):(VMM.attachElement(u.nextDate,VMM.Date.prettyDate(o[f+1].startdate,!1,o[f+1].precisiondate)),VMM.attachElement(u.nextTitle,v)):VMM.attachElement(u.nextTitle,v))),c?VMM.Lib.css(e,"left",-(b-i.slider.content.padding)):(VMM.Lib.stop(e),VMM.Lib.animate(e,w,p,{left:-(b-i.slider.content.padding)})),a&&VMM.fireEvent(s,"LOADED"),r[f].height()>i.slider_height)VMM.Lib.css(".slider","overflow-y","scroll");else{VMM.Lib.css(s,"overflow-y","hidden");y=0;try{y=VMM.Lib.prop(s,"scrollHeight");VMM.Lib.animate(s,w,p,{scrollTop:y-VMM.Lib.height(s)})}catch(g){y=VMM.Lib.height(s)}}ct();VMM.fireEvent(l,"MESSAGE","TEST")}function v(){VMM.Lib.stop(e);VMM.Lib.animate(e,i.duration,"easeOutExpo",{left:-r[f].leftpos()+i.slider.content.padding})}function at(n,t){trace("showMessege "+t);VMM.attachElement(h,"<div class='vco-explainer'><div class='vco-explainer-container'><div class='vco-bezel'><div class='vco-gesture-icon'><\/div><div class='vco-message'><p>"+t+"<\/p><\/div><\/div><\/div><\/div>")}function ft(){VMM.Lib.detach(h)}function vt(){var n="<div class='icon'>&nbsp;<\/div>";u.nextBtn=VMM.appendAndGetElement(l,"<div>","nav-next");u.prevBtn=VMM.appendAndGetElement(l,"<div>","nav-previous");u.nextBtnContainer=VMM.appendAndGetElement(u.nextBtn,"<div>","nav-container",n);u.prevBtnContainer=VMM.appendAndGetElement(u.prevBtn,"<div>","nav-container",n);i.type=="timeline"&&(u.nextDate=VMM.appendAndGetElement(u.nextBtnContainer,"<div>","date",""),u.prevDate=VMM.appendAndGetElement(u.prevBtnContainer,"<div>","date",""));u.nextTitle=VMM.appendAndGetElement(u.nextBtnContainer,"<div>","title","");u.prevTitle=VMM.appendAndGetElement(u.prevBtnContainer,"<div>","title","");VMM.bindEvent(".nav-next",nt);VMM.bindEvent(".nav-previous",tt);VMM.bindEvent(window,st,"keydown")}function yt(){var n=3e3;VMM.attachElement(s,"");l=VMM.getElement(s);y=VMM.appendAndGetElement(l,"<div>","slider-container-mask");e=VMM.appendAndGetElement(y,"<div>","slider-container");p=VMM.appendAndGetElement(e,"<div>","slider-item-container");vt();ht(o);(VMM.Browser.device=="tablet"||VMM.Browser.device=="mobile")&&(i.duration=500,n=1e3,k=new VMM.DragSlider,k.createPanel(l,e,"",i.touch,!0),VMM.bindEvent(k,ot,"DRAGUPDATE"),h=VMM.appendAndGetElement(y,"<div>","vco-feedback",""),at(null,"Swipe to Navigate"),VMM.Lib.height(h,i.slider.height),VMM.bindEvent(h,it),VMM.bindEvent(h,it,"touchend"));w(!1,!0);VMM.Lib.visible(u.prevBtn,!1);c(i.current_slide,"easeOutExpo",n,!0,!0);g=!0}var i,et,l,y,e,p,k,h,o=[],r=[],d=[],f=0,a=960,g=!1,s=n,u={nextBtn:"",prevBtn:"",nextDate:"",prevDate:"",nextTitle:"",prevTitle:""};i=typeof t!="undefined"?t:{preload:4,current_slide:0,interval:10,something:0,width:720,height:400,ease:"easeInOutExpo",duration:1e3,timeline:!1,spacing:15,slider:{width:720,height:400,content:{width:720,height:400,padding:120,padding_default:120},nav:{width:100,height:200}}};this.ver="0.6";i.slider.width=i.width;i.slider.height=i.height;this.init=function(n){r=[];d=[];typeof n!="undefined"?this.setData(n):trace("WAITING ON DATA")};this.width=function(n){if(n!=null&&n!="")i.slider.width=n,w();else return i.slider.width};this.height=function(n){if(n!=null&&n!="")i.slider.height=n,w();else return i.slider.height};this.setData=function(n){typeof n!="undefined"?(o=n,yt()):trace("NO DATA")};this.getData=function(){return o};this.setConfig=function(n){typeof n!="undefined"?i=n:trace("NO CONFIG DATA")};this.getConfig=function(){return i};this.setSize=function(n,t){n!=null&&(i.slider.width=n);t!=null&&(i.slider.height=t);g&&w()};this.active=function(){return g};this.getCurrentNumber=function(){return f};this.setSlide=function(n){c(n)}});typeof VMM.Slider!="undefined"&&(VMM.Slider.Slide=function(n,t){var s,o,u,p,r,i=n,e="",h=!1,a=!1,c=!1,w=!0,v=!1,l="slide_",f={pushque:"",render:"",relayout:"",remove:"",skinny:!1},y={pushque:500,render:100,relayout:100,remove:3e4};l=l+i.uniqueid;this.enqueue=w;this.id=l;e=VMM.appendAndGetElement(t,"<div>","slider-item");typeof i.classname!="undefined"?(trace("HAS CLASSNAME"),VMM.Lib.addClass(e,i.classname)):(trace("NO CLASSNAME"),trace(i));r={slide:"",text:"",media:"",media_element:"",layout:"content-container layout",has:{headline:!1,text:!1,media:!1}};this.show=function(n){w=!1;f.skinny=n;v=!1;clearTimeout(f.remove);h||(a?(clearTimeout(f.relayout),f.relayout=setTimeout(g,y.relayout)):k(n))};this.hide=function(){h&&!v&&(v=!0,clearTimeout(f.remove),f.remove=setTimeout(d,y.remove))};this.clearTimers=function(){clearTimeout(f.relayout);clearTimeout(f.pushque);clearTimeout(f.render)};this.layout=function(n){h&&a&&b(n)};this.elem=function(){return e};this.position=function(){return VMM.Lib.position(e)};this.leftpos=function(n){if(typeof n!="undefined")VMM.Lib.css(e,"left",n);else return VMM.Lib.position(e).left};this.animate=function(n,t,i){VMM.Lib.animate(e,n,t,i)};this.css=function(n,t){VMM.Lib.css(e,n,t)};this.opacity=function(n){VMM.Lib.css(e,"opacity",n)};this.width=function(){return VMM.Lib.width(e)};this.height=function(){return VMM.Lib.height(e)};this.content_height=function(){var n=VMM.Lib.find(e,".content")[0];return n!="undefined"&&n!=null?VMM.Lib.height(n):0};var k=function(n){trace("RENDER "+l);h=!0;a=!0;f.skinny=n;nt();clearTimeout(f.pushque);clearTimeout(f.render);f.pushque=setTimeout(VMM.ExternalAPI.pushQues,y.pushque)},d=function(){trace("REMOVE SLIDE TIMER FINISHED");h=!1;VMM.Lib.detach(o);VMM.Lib.detach(s)},g=function(){h=!0;b(f.skinny,!0)},b=function(n,t){r.has.text?n?(!c||t)&&(VMM.Lib.removeClass(u,"pad-left"),VMM.Lib.detach(o),VMM.Lib.detach(s),VMM.Lib.append(u,o),VMM.Lib.append(u,s),c=!0):(c||t)&&(VMM.Lib.addClass(u,"pad-left"),VMM.Lib.detach(o),VMM.Lib.detach(s),VMM.Lib.append(u,s),VMM.Lib.append(u,o),c=!1):t&&(r.has.headline&&(VMM.Lib.detach(o),VMM.Lib.append(u,o)),VMM.Lib.detach(s),VMM.Lib.append(u,s))},nt=function(){if(trace("BUILDSLIDE"),p=VMM.appendAndGetElement(e,"<div>","content"),u=VMM.appendAndGetElement(p,"<div>"),i.startdate!=null&&i.startdate!=""&&type.of(i.startdate)=="date"&&i.type!="start"){var n=VMM.Date.prettyDate(i.startdate,!1,i.precisiondate),h=VMM.Date.prettyDate(i.enddate,!1,i.precisiondate),t="";i.tag!=null&&i.tag!=""&&(t=VMM.createElement("span",i.tag,"slide-tag"));r.text+=n!=h?VMM.createElement("h2",n+" &mdash; "+h+t,"date"):VMM.createElement("h2",n+t,"date")}i.headline!=null&&i.headline!=""&&(r.has.headline=!0,r.text+=i.type=="start"?VMM.createElement("h2",VMM.Util.linkify_with_twitter(i.headline,"_blank"),"start"):VMM.createElement("h3",VMM.Util.linkify_with_twitter(i.headline,"_blank")));i.text!=null&&i.text!=""&&(r.has.text=!0,r.text+=VMM.createElement("p",VMM.Util.linkify_with_twitter(i.text,"_blank")));(r.has.text||r.has.headline)&&(r.text=VMM.createElement("div",r.text,"container"),o=VMM.appendAndGetElement(u,"<div>","text",VMM.TextElement.create(r.text)));i.needs_slug;i.asset!=null&&i.asset!=""&&i.asset.media!=null&&i.asset.media!=""&&(r.has.media=!0,s=VMM.appendAndGetElement(u,"<div>","media",VMM.MediaElement.create(i.asset,i.uniqueid)));r.has.text&&(r.layout+="-text");r.has.media&&(r.layout+="-media");r.has.text?f.skinny?(VMM.Lib.addClass(u,r.layout),c=!0):(VMM.Lib.addClass(u,r.layout),VMM.Lib.addClass(u,"pad-left"),VMM.Lib.detach(o),VMM.Lib.append(u,o)):VMM.Lib.addClass(u,r.layout)}});Aes={};Aes.cipher=function(n,t){for(var f,e,r=4,o=t.length/r-1,i=[[],[],[],[]],u=0;u<4*r;u++)i[u%4][Math.floor(u/4)]=n[u];for(i=Aes.addRoundKey(i,t,0,r),f=1;f<o;f++)i=Aes.subBytes(i,r),i=Aes.shiftRows(i,r),i=Aes.mixColumns(i,r),i=Aes.addRoundKey(i,t,f,r);for(i=Aes.subBytes(i,r),i=Aes.shiftRows(i,r),i=Aes.addRoundKey(i,t,o,r),e=new Array(4*r),u=0;u<4*r;u++)e[u]=i[u%4][Math.floor(u/4)];return e};Aes.keyExpansion=function(n){for(var s,i,e=4,r=n.length/4,o=r+6,f=new Array(e*(o+1)),u=new Array(4),t=0;t<r;t++)s=[n[4*t],n[4*t+1],n[4*t+2],n[4*t+3]],f[t]=s;for(t=r;t<e*(o+1);t++){for(f[t]=new Array(4),i=0;i<4;i++)u[i]=f[t-1][i];if(t%r==0)for(u=Aes.subWord(Aes.rotWord(u)),i=0;i<4;i++)u[i]^=Aes.rCon[t/r][i];else r>6&&t%r==4&&(u=Aes.subWord(u));for(i=0;i<4;i++)f[t][i]=f[t-r][i]^u[i]}return f};Aes.subBytes=function(n,t){for(var r,i=0;i<4;i++)for(r=0;r<t;r++)n[i][r]=Aes.sBox[n[i][r]];return n};Aes.shiftRows=function(n,t){for(var i,u=new Array(4),r=1;r<4;r++){for(i=0;i<4;i++)u[i]=n[r][(i+r)%t];for(i=0;i<4;i++)n[r][i]=u[i]}return n};Aes.mixColumns=function(n){for(var t,r,u,i=0;i<4;i++){for(t=new Array(4),r=new Array(4),u=0;u<4;u++)t[u]=n[u][i],r[u]=n[u][i]&128?n[u][i]<<1^283:n[u][i]<<1;n[0][i]=r[0]^t[1]^r[1]^t[2]^t[3];n[1][i]=t[0]^r[1]^t[2]^r[2]^t[3];n[2][i]=t[0]^t[1]^r[2]^t[3]^r[3];n[3][i]=t[0]^r[0]^t[1]^t[2]^r[3]}return n};Aes.addRoundKey=function(n,t,i,r){for(var f,u=0;u<4;u++)for(f=0;f<r;f++)n[u][f]^=t[i*4+f][u];return n};Aes.subWord=function(n){for(var t=0;t<4;t++)n[t]=Aes.sBox[n[t]];return n};Aes.rotWord=function(n){for(var i=n[0],t=0;t<3;t++)n[t]=n[t+1];return n[3]=i,n};Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];Aes.Ctr={};Aes.Ctr.encrypt=function(n,t,i){var o=16,h,c,s,a,f,u,r,b;if(!(i==128||i==192||i==256))return"";for(n=Utf8.encode(n),t=Utf8.encode(t),h=i/8,c=new Array(h),r=0;r<h;r++)c[r]=isNaN(t.charCodeAt(r))?0:t.charCodeAt(r);s=Aes.cipher(c,Aes.keyExpansion(c));s=s.concat(s.slice(0,h-16));var e=new Array(o),y=(new Date).getTime(),k=y%1e3,d=Math.floor(y/1e3),g=Math.floor(Math.random()*65535);for(r=0;r<2;r++)e[r]=k>>>r*8&255;for(r=0;r<2;r++)e[r+2]=g>>>r*8&255;for(r=0;r<4;r++)e[r+4]=d>>>r*8&255;for(a="",r=0;r<8;r++)a+=String.fromCharCode(e[r]);var nt=Aes.keyExpansion(s),v=Math.ceil(n.length/o),p=new Array(v);for(f=0;f<v;f++){for(u=0;u<4;u++)e[15-u]=f>>>u*8&255;for(u=0;u<4;u++)e[11-u]=f/4294967296>>>u*8;var tt=Aes.cipher(e,nt),w=f<v-1?o:(n.length-1)%o+1,l=new Array(w);for(r=0;r<w;r++)l[r]=tt[r]^n.charCodeAt(f*o+r),l[r]=String.fromCharCode(l[r]);p[f]=l.join("")}return b=a+p.join(""),Base64.encode(b)};Aes.Ctr.decrypt=function(n,t,i){var h=16,c,l,e,o,v,u,f,p,s,r,w;if(!(i==128||i==192||i==256))return"";for(n=Base64.decode(n),t=Utf8.encode(t),c=i/8,l=new Array(c),r=0;r<c;r++)l[r]=isNaN(t.charCodeAt(r))?0:t.charCodeAt(r);for(e=Aes.cipher(l,Aes.keyExpansion(l)),e=e.concat(e.slice(0,c-16)),o=new Array(8),ctrTxt=n.slice(0,8),r=0;r<8;r++)o[r]=ctrTxt.charCodeAt(r);var b=Aes.keyExpansion(e),a=Math.ceil((n.length-8)/h),y=new Array(a);for(u=0;u<a;u++)y[u]=n.slice(8+u*h,8+u*h+h);for(n=y,v=new Array(n.length),u=0;u<a;u++){for(f=0;f<4;f++)o[15-f]=u>>>f*8&255;for(f=0;f<4;f++)o[11-f]=(u+1)/4294967296-1>>>f*8&255;for(p=Aes.cipher(o,b),s=new Array(n[u].length),r=0;r<n[u].length;r++)s[r]=p[r]^n[u].charCodeAt(r),s[r]=String.fromCharCode(s[r]);v[u]=s.join("")}return w=v.join(""),Utf8.decode(w)};Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Base64.encode=function(n,t){t=typeof t=="undefined"?!1:t;var s,h,c,u,l,a,v,y,p=[],e="",i,r,o,f=Base64.code;if(r=t?n.encodeUTF8():n,i=r.length%3,i>0)while(i++<3)e+="=",r+='\0';for(i=0;i<r.length;i+=3)s=r.charCodeAt(i),h=r.charCodeAt(i+1),c=r.charCodeAt(i+2),u=s<<16|h<<8|c,l=u>>18&63,a=u>>12&63,v=u>>6&63,y=u&63,p[i/3]=f.charAt(l)+f.charAt(a)+f.charAt(v)+f.charAt(y);return o=p.join(""),o.slice(0,o.length-e.length)+e};Base64.decode=function(n,t){var e,s,a,v,y,h,c,o,u,l,r,f,i;for(t=typeof t=="undefined"?!1:t,u=[],f=Base64.code,r=t?n.decodeUTF8():n,i=0;i<r.length;i+=4)v=f.indexOf(r.charAt(i)),y=f.indexOf(r.charAt(i+1)),h=f.indexOf(r.charAt(i+2)),c=f.indexOf(r.charAt(i+3)),o=v<<18|y<<12|h<<6|c,e=o>>>16&255,s=o>>>8&255,a=o&255,u[i/4]=String.fromCharCode(e,s,a),c==64&&(u[i/4]=String.fromCharCode(e,s)),h==64&&(u[i/4]=String.fromCharCode(e));return l=u.join(""),t?l.decodeUTF8():l};Utf8={};Utf8.encode=function(n){var t=n.replace(/[\u0080-\u07ff]/g,function(n){var t=n.charCodeAt(0);return String.fromCharCode(192|t>>6,128|t&63)});return t.replace(/[\u0800-\uffff]/g,function(n){var t=n.charCodeAt(0);return String.fromCharCode(224|t>>12,128|t>>6&63,128|t&63)})};Utf8.decode=function(n){var t=n.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(n){var t=(n.charCodeAt(0)&15)<<12|(n.charCodeAt(1)&63)<<6|n.charCodeAt(2)&63;return String.fromCharCode(t)});return t.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(n){var t=(n.charCodeAt(0)&31)<<6|n.charCodeAt(1)&63;return String.fromCharCode(t)})};!function(n){"use strict";var t=function(n,t){this.init("tooltip",n,t)};t.prototype={constructor:t,init:function(t,i,r){var u,f;if(this.type=t,this.$element=n(i),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger!="manual"){u=this.options.trigger=="hover"?"mouseenter":"focus";f=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(u,this.options.selector,n.proxy(this.enter,this));this.$element.on(f,this.options.selector,n.proxy(this.leave,this))}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=n.extend({},n.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var i=n(t.currentTarget)[this.type](this._options).data(this.type);i.options.delay&&i.options.delay.show?(i.hoverState="in",setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)):i.show()},leave:function(t){var i=n(t.currentTarget)[this.type](this._options).data(this.type);i.options.delay&&i.options.delay.hide?(i.hoverState="out",setTimeout(function(){i.hoverState=="out"&&i.hide()},i.options.delay.hide)):i.hide()},show:function(){var t,u,n,f,e,i,r;if(this.hasContent()&&this.enabled){t=this.tip();this.setContent();this.options.animation&&t.addClass("fade");i=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement;u=/in/.test(i);t.remove().css({top:0,left:0,display:"block"}).appendTo(u?this.$element:document.body);n=this.getPosition(u);f=t[0].offsetWidth;e=t[0].offsetHeight;switch(u?i.split(" ")[1]:i){case"bottom":r={top:n.top+n.height,left:n.left+n.width/2-f/2};break;case"top":r={top:n.top-e,left:n.left+n.width/2-f/2};break;case"left":r={top:n.top+n.height/2-e/2,left:n.left-f};break;case"right":r={top:n.top+n.height/2-e/2,left:n.left+n.width}}t.css(r).addClass(i).addClass("in")}},setContent:function(){var n=this.tip();n.find(".timeline-tooltip-inner").html(this.getTitle());n.removeClass("fade in top bottom left right")},hide:function(){function i(){var i=setTimeout(function(){t.off(n.support.transition.end).remove()},500);t.one(n.support.transition.end,function(){clearTimeout(i);t.remove()})}var r=this,t=this.tip();t.removeClass("in");n.support.transition&&this.$tip.hasClass("fade")?i():t.remove()},fixTitle:function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return n.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var t,i=this.$element,n=this.options;return t=i.attr("data-original-title")||(typeof n.title=="function"?n.title.call(i[0]):n.title),t.toString().replace(/(^\s*|\s*$)/,"")},tip:function(){return this.$tip=this.$tip||n(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};n.fn.tooltip=function(i){return this.each(function(){var u=n(this),r=u.data("tooltip"),f=typeof i=="object"&&i;r||u.data("tooltip",r=new t(this,f));typeof i=="string"&&r[i]()})};n.fn.tooltip.Constructor=t;n.fn.tooltip.defaults={animation:!0,delay:0,selector:!1,placement:"top",trigger:"hover",title:"",template:'<div class="timeline-tooltip"><div class="timeline-tooltip-arrow"><\/div><div class="timeline-tooltip-inner"><\/div><\/div>'}}(window.jQuery);typeof VMM!="undefined"&&typeof VMM.StoryJS=="undefined"&&(VMM.StoryJS=function(){this.init=function(){}});typeof VMM!="undefined"&&typeof VMM.Timeline=="undefined"&&(VMM.Timeline=function(n,t,i){function st(n){typeof embed_config=="object"&&(timeline_config=embed_config);typeof timeline_config=="object"?(trace("HAS TIMELINE CONFIG"),r=VMM.Util.mergeConfig(r,timeline_config)):typeof n=="object"&&(r=VMM.Util.mergeConfig(r,n));(VMM.Browser.device=="mobile"||VMM.Browser.device=="tablet")&&(r.touch=!0);r.nav.width=r.width;r.nav.height=200;r.feature.width=r.width;r.feature.height=r.height-r.nav.height;r.nav.zoom.adjust=parseInt(r.start_zoom_adjust,10);VMM.Timeline.Config=r;VMM.master_config.Timeline=VMM.Timeline.Config;this.events=r.events;r.gmap_key!=""&&(r.api_keys.google=r.gmap_key);trace("VERSION "+r.version);ot=r.version}function ht(){f=VMM.getElement(y);VMM.Lib.addClass(f,"vco-timeline");VMM.Lib.addClass(f,"vco-storyjs");v=VMM.appendAndGetElement(f,"<div>","vco-container vco-main");b=VMM.appendAndGetElement(v,"<div>","vco-feature");c=VMM.appendAndGetElement(b,"<div>","vco-slider");l=VMM.appendAndGetElement(v,"<div>","vco-navigation");h=VMM.appendAndGetElement(f,"<div>","vco-feedback","");typeof r.language.right_to_left!="undefined"&&VMM.Lib.addClass(f,"vco-right-to-left");o=new VMM.Slider(c,r);s=new VMM.Timeline.TimeNav(l);k?VMM.Lib.width(f,r.width):r.width=VMM.Lib.width(f);d?VMM.Lib.height(f,r.height):r.height=VMM.Lib.height(f);r.touch?VMM.Lib.addClass(f,"vco-touch"):VMM.Lib.addClass(f,"vco-notouch")}function ct(n,t){trace("onDataReady");u=t.timeline;type.of(u.era)!="array"&&(u.era=[]);gt()}function lt(){dt()}function g(){et();o.setSize(r.feature.width,r.feature.height);s.setSize(r.width,r.height);wt()&&rt()}function at(){r.loaded.slider=!0;nt()}function nt(){r.loaded.percentloaded=r.loaded.percentloaded+25;r.loaded.slider&&r.loaded.timenav&&kt()}function vt(){r.loaded.timenav=!0;nt()}function yt(){a=!0;r.current_slide=o.getCurrentNumber();it(r.current_slide);s.setMarker(r.current_slide,r.ease,r.duration)}function pt(){a=!0;r.current_slide=s.getCurrentNumber();it(r.current_slide);o.setSlide(r.current_slide)}function tt(n){n<=e.length-1&&n>=0&&(r.current_slide=n,o.setSlide(r.current_slide),s.setMarker(r.current_slide,r.ease,r.duration))}function it(n){r.hash_bookmark&&(window.location.hash="#"+n.toString())}function rt(){var t="",n=ut(window.orientation);VMM.Browser.device=="mobile"?t=n=="portrait"?"width=device-width; initial-scale=0.5, maximum-scale=0.5":n=="landscape"?"width=device-width; initial-scale=0.5, maximum-scale=0.5":"width=device-width, initial-scale=1, maximum-scale=1.0":VMM.Browser.device=="tablet";document.getElementById("viewport")}function ut(n){return n==0||n==180?"portrait":n==90||n==-90?"landscape":"normal"}function wt(){var n=ut(window.orientation);return n==r.orientation?!1:(r.orientation=n,!0)}function bt(n,t,i){trace("showMessege "+t);i?VMM.attachElement(h,t):VMM.attachElement(h,VMM.MediaElement.loadingmessage(t))}function kt(){VMM.Lib.animate(h,r.duration,r.ease*4,{opacity:0},ft)}function ft(){VMM.Lib.detach(h)}function dt(){parseInt(r.start_at_slide)>0&&r.current_slide==0&&(r.current_slide=parseInt(r.start_at_slide));r.start_at_end&&r.current_slide==0&&(r.current_slide=e.length-1);p?(p=!0,VMM.fireEvent(global,r.events.messege,"Internet Explorer "+VMM.Browser.version+" is not supported by TimelineJS. Please update your browser to version 8 or higher.")):(ft(),g(),VMM.bindEvent(c,at,"LOADED"),VMM.bindEvent(l,vt,"LOADED"),VMM.bindEvent(c,yt,"UPDATE"),VMM.bindEvent(l,pt,"UPDATE"),o.init(e),s.init(e,u.era),VMM.bindEvent(global,g,r.events.resize))}function et(){trace("UPDATE SIZE");r.width=VMM.Lib.width(f);r.height=VMM.Lib.height(f);r.nav.width=r.width;r.feature.width=r.width;r.feature.height=r.height-r.nav.height-3;VMM.Browser.device=="mobile";r.width<641?VMM.Lib.addClass(f,"vco-skinny"):VMM.Lib.removeClass(f,"vco-skinny")}function gt(){var t,o,f,n,s,i;for(e=[],VMM.fireEvent(global,r.events.messege,"Building Dates"),et(),t=0;t<u.date.length;t++)u.date[t].startDate!=null&&u.date[t].startDate!=""&&(n={},f=VMM.Date.parse(u.date[t].startDate,!0),n.startdate=f.date,n.precisiondate=f.precision,isNaN(n.startdate)||(n.enddate=u.date[t].endDate!=null&&u.date[t].endDate!=""?VMM.Date.parse(u.date[t].endDate):n.startdate,n.needs_slug=!1,u.date[t].headline==""&&u.date[t].slug!=null&&u.date[t].slug!=""&&(n.needs_slug=!0),n.title=u.date[t].headline,n.headline=u.date[t].headline,n.type=u.date[t].type,n.date=VMM.Date.prettyDate(n.startdate,!1,n.precisiondate),n.asset=u.date[t].asset,n.fulldate=n.startdate.getTime(),n.text=u.date[t].text,n.content="",n.tag=u.date[t].tag,n.slug=u.date[t].slug,n.uniqueid=VMM.Util.unique_ID(7),n.classname=u.date[t].classname,e.push(n)));u.type!="storify"&&e.sort(function(n,t){return n.fulldate-t.fulldate});u.headline!=null&&u.headline!=""&&u.text!=null&&u.text!=""&&(n={},s=0,typeof u.startDate!="undefined"?(f=VMM.Date.parse(u.startDate,!0),o=f.date):o=!1,trace("HAS STARTPAGE"),trace(o),o&&o<e[0].startdate?n.startdate=new Date(o):(i=e[0].startdate,n.startdate=new Date(e[0].startdate),i.getMonth()===0&&i.getDate()==1&&i.getHours()===0&&i.getMinutes()===0?n.startdate.setFullYear(i.getFullYear()-1):i.getDate()<=1&&i.getHours()===0&&i.getMinutes()===0?n.startdate.setMonth(i.getMonth()-1):i.getHours()===0&&i.getMinutes()===0?n.startdate.setDate(i.getDate()-1):i.getMinutes()===0?n.startdate.setHours(i.getHours()-1):n.startdate.setMinutes(i.getMinutes()-1)),n.uniqueid=VMM.Util.unique_ID(7),n.enddate=n.startdate,n.precisiondate=f.precision,n.title=u.headline,n.headline=u.headline,n.text=u.text,n.type="start",n.date=VMM.Date.prettyDate(u.startDate,!1,n.precisiondate),n.asset=u.asset,n.slug=!1,n.needs_slug=!1,n.fulldate=n.startdate.getTime(),r.embed&&VMM.fireEvent(global,r.events.headline,n.headline),e.unshift(n));u.type!="storify"&&e.sort(function(n,t){return n.fulldate-t.fulldate});lt()}var f,v,b,h,c,l,o,s,ot="2.x",y="#timelinejs",u={},e=[],r={},k=!1,d=!1,p=!1,a=!1,w;y=type.of(n)=="string"?n.match("#")?n:"#"+n:"#timelinejs";r={embed:!1,events:{data_ready:"DATAREADY",messege:"MESSEGE",headline:"HEADLINE",slide_change:"SLIDE_CHANGE",resize:"resize"},id:y,source:"nothing",type:"timeline",touch:!1,orientation:"normal",maptype:"toner",version:"2.x",preload:4,current_slide:0,hash_bookmark:!1,start_at_end:!1,start_at_slide:0,start_zoom_adjust:0,start_page:!1,api_keys:{google:"",flickr:"",twitter:""},interval:10,something:0,width:960,height:540,spacing:15,loaded:{slider:!1,timenav:!1,percentloaded:0},nav:{start_page:!1,interval_width:200,density:4,minor_width:0,minor_left:0,constraint:{left:0,right:0,right_min:0,right_max:0},zoom:{adjust:0},multiplier:{current:6,min:.1,max:50},rows:[1,1,1],width:960,height:200,marker:{width:150,height:50}},feature:{width:960,height:540},slider:{width:720,height:400,content:{width:720,height:400,padding:130,padding_default:130},nav:{width:100,height:200}},ease:"easeInOutExpo",duration:1e3,gmap_key:"",language:VMM.Language};t!=null&&t!=""&&(r.width=t,k=!0);i!=null&&i!=""&&(r.height=i,d=!0);window.location.hash&&(w=window.location.hash.substring(1),isNaN(w)||(r.current_slide=parseInt(w)));window.onhashchange=function(){var n=window.location.hash.substring(1);r.hash_bookmark?a?tt(parseInt(n)):a=!1:tt(parseInt(n))};this.init=function(n,t){trace("INIT");rt();st(n);ht();type.of(t)!==null&&(r.source=t);VMM.Date.setLanguage(r.language);VMM.master_config.language=r.language;VMM.ExternalAPI.setKeys(r.api_keys);VMM.ExternalAPI.googlemaps.setMapType(r.maptype);VMM.bindEvent(global,ct,r.events.data_ready);VMM.bindEvent(global,bt,r.events.messege);VMM.fireEvent(global,r.events.messege,r.language.messages.loading_timeline);(VMM.Browser.browser=="Explorer"||VMM.Browser.browser=="MSIE")&&parseInt(VMM.Browser.version,10)<=7&&(p=!0);type.of(r.source)=="string"||type.of(r.source)=="object"?VMM.Timeline.DataObj.getData(r.source):VMM.fireEvent(global,r.events.messege,"No data source provided")};this.iframeLoaded=function(){trace("iframeLoaded")};this.reload=function(n){trace("Load new timeline data"+n);VMM.fireEvent(global,r.events.messege,r.language.messages.loading_timeline);u={};VMM.Timeline.DataObj.getData(n);r.current_slide=0;o.setSlide(0);s.setMarker(0,r.ease,r.duration)}},VMM.Timeline.Config={});typeof VMM.Timeline!="undefined"&&typeof VMM.Timeline.TimeNav=="undefined"&&(VMM.Timeline.TimeNav=function(n,t,r){function ti(n){u.nav.constraint.left=u.width/2;u.nav.constraint.right=u.nav.constraint.right_min-u.width/2;d.updateConstraint(u.nav.constraint);VMM.Lib.css(dt,"left",Math.round(u.width/2)+2);VMM.Lib.css(gt,"left",Math.round(u.width/2)-8);yt(u.current_slide,u.ease,u.duration,!0,n)}function ii(){VMM.fireEvent(b,"UPDATE")}function ri(){d.cancelSlide();u.nav.multiplier.current>u.nav.multiplier.min&&(u.nav.multiplier.current=u.nav.multiplier.current<=1?u.nav.multiplier.current-.25:u.nav.multiplier.current>5?u.nav.multiplier.current>16?Math.round(u.nav.multiplier.current-10):Math.round(u.nav.multiplier.current-4):Math.round(u.nav.multiplier.current-1),u.nav.multiplier.current<=0&&(u.nav.multiplier.current=u.nav.multiplier.min),ei())}function ui(){d.cancelSlide();u.nav.multiplier.current<u.nav.multiplier.max&&(u.nav.multiplier.current=u.nav.multiplier.current>4?u.nav.multiplier.current>16?Math.round(u.nav.multiplier.current+10):Math.round(u.nav.multiplier.current+4):Math.round(u.nav.multiplier.current+1),u.nav.multiplier.current>=u.nav.multiplier.max&&(u.nav.multiplier.current=u.nav.multiplier.max),ei())}function li(){d.cancelSlide();yt(0);ii()}function fi(n){var i=0,t=0;n||(n=window.event);n.originalEvent&&(n=n.originalEvent);typeof n.wheelDeltaX!="undefined"&&(i=n.wheelDeltaY/6,i=Math.abs(n.wheelDeltaX)>Math.abs(n.wheelDeltaY)?n.wheelDeltaX/6:0);i&&(n.preventDefault&&n.preventDefault(),n.returnValue=!1);t=VMM.Lib.position(y).left+i;t>u.nav.constraint.left?t=u.width/2:t<u.nav.constraint.right&&(t=u.nav.constraint.right);VMM.Lib.css(y,"left",t)}function ei(){trace("config.nav.multiplier "+u.nav.multiplier.current);oi(!0);si(!0);ot(rt,it,!0,!0);ot(ht,ft,!0);u.nav.constraint.left=u.width/2;u.nav.constraint.right=u.nav.constraint.right_min-u.width/2;d.updateConstraint(u.nav.constraint)}function ai(n){d.cancelSlide();yt(n.data.number);ii()}function vi(n){VMM.Lib.toggleClass(n.data.elem,"zFront")}function yt(n,t,i){var r;trace("GO TO MARKER");var f=u.ease,e=u.duration,o=!1,s=!1;for(nt=n,c.left=u.width/2-h[nt].pos_left,c.visible.left=Math.abs(c.left)-100,c.visible.right=Math.abs(c.left)+u.width+100,nt==0&&(s=!0),nt+1==h.length&&(o=!0),t!=null&&t!=""&&(f=t),i!=null&&i!=""&&(e=i),r=0;r<h.length;r++)VMM.Lib.removeClass(h[r].marker,"active");u.start_page&&h[0].type=="start"&&(VMM.Lib.visible(h[0].marker,!1),VMM.Lib.addClass(h[0].marker,"start"));VMM.Lib.addClass(h[nt].marker,"active");VMM.Lib.stop(y);VMM.Lib.animate(y,e,f,{left:c.left})}function yi(){for(var i=0,t=0,r=0,u=[],n=0,f,n=0;n<h.length;n++)e[n].type=="start"||(f=pt(s,h[n].relative_pos),i=t,t=f.begin,r=t-i,u.push(r));return VMM.Util.average(u).mean}function pi(){for(var t=u.nav.multiplier.current,n=0,n=0;n<t;n++)yi()<75&&u.nav.multiplier.current>1&&(u.nav.multiplier.current=u.nav.multiplier.current-1)}function wi(){var n=et(e[0].startdate),t=et(e[e.length-1].enddate);f.eon.type="eon";f.eon.first=n.eons;f.eon.base=Math.floor(n.eons);f.eon.last=t.eons;f.eon.number=o.eons;f.eon.multiplier=l.eons;f.eon.minor=l.eons;f.era.type="era";f.era.first=n.eras;f.era.base=Math.floor(n.eras);f.era.last=t.eras;f.era.number=o.eras;f.era.multiplier=l.eras;f.era.minor=l.eras;f.epoch.type="epoch";f.epoch.first=n.epochs;f.epoch.base=Math.floor(n.epochs);f.epoch.last=t.epochs;f.epoch.number=o.epochs;f.epoch.multiplier=l.epochs;f.epoch.minor=l.epochs;f.age.type="age";f.age.first=n.ages;f.age.base=Math.floor(n.ages);f.age.last=t.ages;f.age.number=o.ages;f.age.multiplier=l.ages;f.age.minor=l.ages;f.millenium.type="millenium";f.millenium.first=n.milleniums;f.millenium.base=Math.floor(n.milleniums);f.millenium.last=t.milleniums;f.millenium.number=o.milleniums;f.millenium.multiplier=l.millenium;f.millenium.minor=l.millenium;f.century.type="century";f.century.first=n.centuries;f.century.base=Math.floor(n.centuries);f.century.last=t.centuries;f.century.number=o.centuries;f.century.multiplier=l.century;f.century.minor=l.century;f.decade.type="decade";f.decade.first=n.decades;f.decade.base=Math.floor(n.decades);f.decade.last=t.decades;f.decade.number=o.decades;f.decade.multiplier=l.decade;f.decade.minor=l.decade;f.year.type="year";f.year.first=n.years;f.year.base=Math.floor(n.years);f.year.last=t.years;f.year.number=o.years;f.year.multiplier=1;f.year.minor=l.month;f.month.type="month";f.month.first=n.months;f.month.base=Math.floor(n.months);f.month.last=t.months;f.month.number=o.months;f.month.multiplier=1;f.month.minor=Math.round(l.week);f.week.type="week";f.week.first=n.weeks;f.week.base=Math.floor(n.weeks);f.week.last=t.weeks;f.week.number=o.weeks;f.week.multiplier=1;f.week.minor=7;f.day.type="day";f.day.first=n.days;f.day.base=Math.floor(n.days);f.day.last=t.days;f.day.number=o.days;f.day.multiplier=1;f.day.minor=24;f.hour.type="hour";f.hour.first=n.hours;f.hour.base=Math.floor(n.hours);f.hour.last=t.hours;f.hour.number=o.hours;f.hour.multiplier=1;f.hour.minor=60;f.minute.type="minute";f.minute.first=n.minutes;f.minute.base=Math.floor(n.minutes);f.minute.last=t.minutes;f.minute.number=o.minutes;f.minute.multiplier=1;f.minute.minor=60;f.second.type="decade";f.second.first=n.seconds;f.second.base=Math.floor(n.seconds);f.second.last=t.seconds;f.second.number=o.seconds;f.second.multiplier=1;f.second.minor=10}function et(n){var t={};return t.days=n/a.day,t.weeks=t.days/a.week,t.months=t.days/a.month,t.years=t.months/a.year,t.hours=t.days*a.hour,t.minutes=t.days*a.minute,t.seconds=t.days*a.second,t.decades=t.years/a.decade,t.centuries=t.years/a.century,t.milleniums=t.years/a.millenium,t.ages=t.years/a.age,t.epochs=t.years/a.epoch,t.eras=t.years/a.era,t.eons=t.years/a.eon,t}function bt(n,t,i){var f,e,u=n.type,r={start:"",end:"",type:u};return f=et(t),r.start=t.months,u=="eon"?r.start=f.eons:u=="era"?r.start=f.eras:u=="epoch"?r.start=f.epochs:u=="age"?r.start=f.ages:u=="millenium"?r.start=t.milleniums:u=="century"?r.start=f.centuries:u=="decade"?r.start=f.decades:u=="year"?r.start=f.years:u=="month"?r.start=f.months:u=="week"?r.start=f.weeks:u=="day"?r.start=f.days:u=="hour"?r.start=f.hours:u=="minute"&&(r.start=f.minutes),type.of(i)=="date"?(e=et(i),r.end=i.months,u=="eon"?r.end=e.eons:u=="era"?r.end=e.eras:u=="epoch"?r.end=e.epochs:u=="age"?r.end=e.ages:u=="millenium"?r.end=i.milleniums:u=="century"?r.end=e.centuries:u=="decade"?r.end=e.decades:u=="year"?r.end=e.years:u=="month"?r.end=e.months:u=="week"?r.end=e.weeks:u=="day"?r.end=e.days:u=="hour"?r.end=e.hours:u=="minute"&&(r.end=e.minutes)):r.end=r.start,r}function pt(n,t){return{begin:(t.start-s.base)*(u.nav.interval_width/u.nav.multiplier.current),end:(t.end-s.base)*(u.nav.interval_width/u.nav.multiplier.current)}}function oi(n){var f=2,k=0,d=-2,g=0,tt=0,o=u.width,w=[],l={left:c.visible.left-o,right:c.visible.right+o},r=0,e=0;for(u.nav.minor_width=u.width,VMM.Lib.removeClass(".flag","row1"),VMM.Lib.removeClass(".flag","row2"),VMM.Lib.removeClass(".flag","row3"),r=0;r<h.length;r++){var a,i=h[r],t=pt(s,h[r].relative_pos),p=0,it=!1,b={id:r,pos:0,row:0};if(t.begin=Math.round(t.begin+d),t.end=Math.round(t.end+d),a=Math.round(t.end-t.begin),i.pos_left=t.begin,nt==r&&(c.left=u.width/2-t,c.visible.left=Math.abs(c.left),c.visible.right=Math.abs(c.left)+u.width,l.left=c.visible.left-o,l.right=c.visible.right+o),Math.abs(t.begin)>=l.left&&Math.abs(t.begin)<=l.right&&(it=!0),n?(VMM.Lib.stop(i.marker),VMM.Lib.animate(i.marker,u.duration/2,u.ease,{left:t.begin})):(VMM.Lib.stop(i.marker),VMM.Lib.css(i.marker,"left",t.begin)),r==nt&&(tt=t.begin),a>5&&(VMM.Lib.css(i.lineevent,"height",6),VMM.Lib.css(i.lineevent,"top",150),n?VMM.Lib.animate(i.lineevent,u.duration/2,u.ease,{width:a}):VMM.Lib.css(i.lineevent,"width",a)),v.length>0){for(e=0;e<v.length;e++)e<u.nav.rows.current.length&&i.tag==v[e]&&(f=e,e==u.nav.rows.current.length-1&&(trace("ON LAST ROW"),VMM.Lib.addClass(i.flag,"flag-small-last")));p=u.nav.rows.current[f]}else t.begin-k.begin<u.nav.marker.width+u.spacing?f<u.nav.rows.current.length-1?f++:(f=0,g++):(g=1,f=1),p=u.nav.rows.current[f];k=t;b.pos=t;b.row=f;w.push(b);w.length>6&&w.remove(0);n?(VMM.Lib.stop(i.flag),VMM.Lib.animate(i.flag,u.duration,u.ease,{top:p})):(VMM.Lib.stop(i.flag),VMM.Lib.css(i.flag,"top",p));u.start_page&&h[r].type=="start"&&VMM.Lib.visible(i.marker,!1);t>u.nav.minor_width&&(u.nav.minor_width=t);t<u.nav.minor_left&&(u.nav.minor_left=t)}n&&(VMM.Lib.stop(y),VMM.Lib.animate(y,u.duration/2,u.ease,{left:u.width/2-tt}))}function si(n){for(var f=0,i=0,f=0;f<vt.length;f++){var t=vt[f],r=pt(s,t.relative_pos),e=0,h=0,o=u.nav.marker.height*u.nav.rows.full.length,c=r.end-r.begin;if(t.tag!=""){for(o=u.nav.marker.height*u.nav.rows.full.length/u.nav.rows.current.length,i=0;i<v.length;i++)i<u.nav.rows.current.length&&t.tag==v[i]&&(h=i);e=u.nav.rows.current[h]}else e=-1;n?(VMM.Lib.stop(t.content),VMM.Lib.stop(t.text_content),VMM.Lib.animate(t.content,u.duration/2,u.ease,{top:e,left:r.begin,width:c,height:o}),VMM.Lib.animate(t.text_content,u.duration/2,u.ease,{left:r.begin})):(VMM.Lib.stop(t.content),VMM.Lib.stop(t.text_content),VMM.Lib.css(t.content,"left",r.begin),VMM.Lib.css(t.content,"width",c),VMM.Lib.css(t.content,"height",o),VMM.Lib.css(t.content,"top",e),VMM.Lib.css(t.text_content,"left",r.begin))}}function ot(n,t,r,f){var a=0,y=u.width,p={left:c.visible.left-y,right:c.visible.right+y};for(not_too_many=!0,i=0,u.nav.minor_left=0,t.length>100&&(not_too_many=!1,trace("TOO MANY "+t.length)),i=0;i<t.length;i++){var l=t[i].element,k=t[i].date,w=t[i].visible,b=pt(s,t[i].relative_pos),o=b.begin,e=t[i].animation,h=!0,v=!1;e.pos=o;e.animate=!1;Math.abs(o)>=p.left&&Math.abs(o)<=p.right&&(v=!0);!0&&(u.nav.multiplier.current>16&&f?h=!1:o-a<65&&(o-a<35?i%4==0?o==0&&(h=!1):h=!1:VMM.Util.isEven(i)||(h=!1)),h?t[i].is_detached&&(VMM.Lib.append(n,l),t[i].is_detached=!1):(t[i].is_detached=!0,VMM.Lib.detach(l)),w?h?(e.opacity="100",r&&v&&(e.animate=!0)):(e.opacity="0",r&&not_too_many&&(e.animate=!0),t[i].interval_visible=!1):(e.opacity="100",h?(r&&not_too_many?e.animate=!0:r&&v&&(e.animate=!0),t[i].interval_visible=!0):r&&not_too_many&&(e.animate=!0)),a=o,o>u.nav.minor_width&&(u.nav.minor_width=o),o<u.nav.minor_left&&(u.nav.minor_left=o));e.animate?VMM.Lib.animate(l,u.duration/2,u.ease,{opacity:e.opacity,left:e.pos}):(VMM.Lib.css(l,"opacity",e.opacity),VMM.Lib.css(l,"left",o))}u.nav.constraint.right_min=-u.nav.minor_width+u.width;u.nav.constraint.right=u.nav.constraint.right_min+u.width/2;VMM.Lib.css(ct,"left",u.nav.minor_left-u.width/2);VMM.Lib.width(ct,u.nav.minor_width+u.width+Math.abs(u.nav.minor_left))}function hi(n,t,i){var f=0,o=!0,y=0,l=0,a,u,p=Math.ceil(n.number)+2,c={flag:!1,offset:0},v=0,h,r;for(VMM.attachElement(i,""),n.date=new Date(e[0].startdate.getFullYear(),0,1,0,0,0),a=n.date.getTimezoneOffset(),v=0;v<p;v++)trace(n.type),h=!1,r={element:VMM.appendAndGetElement(i,"<div>",n.classname),date:new Date(e[0].startdate.getFullYear(),0,1,0,0,0),visible:!1,date_string:"",type:n.interval_type,relative_pos:0,is_detached:!1,animation:{animate:!1,pos:"",opacity:"100"}},n.type=="eon"?(o&&(u=Math.floor(e[0].startdate.getFullYear()/5e8)*5e8),r.date.setFullYear(u+f*5e8),h=!0):n.type=="era"?(o&&(u=Math.floor(e[0].startdate.getFullYear()/1e8)*1e8),r.date.setFullYear(u+f*1e8),h=!0):n.type=="epoch"?(o&&(u=Math.floor(e[0].startdate.getFullYear()/1e7)*1e7),r.date.setFullYear(u+f*1e7),h=!0):n.type=="age"?(o&&(u=Math.floor(e[0].startdate.getFullYear()/1e6)*1e6),r.date.setFullYear(u+f*1e6),h=!0):n.type=="millenium"?(o&&(u=Math.floor(e[0].startdate.getFullYear()/1e3)*1e3),r.date.setFullYear(u+f*1e3),h=!0):n.type=="century"?(o&&(u=Math.floor(e[0].startdate.getFullYear()/100)*100),r.date.setFullYear(u+f*100),h=!0):n.type=="decade"?(o&&(u=Math.floor(e[0].startdate.getFullYear()/10)*10),r.date.setFullYear(u+f*10),h=!0):n.type=="year"?(o&&(u=e[0].startdate.getFullYear()),r.date.setFullYear(u+f),h=!0):n.type=="month"?(o&&(u=e[0].startdate.getMonth()),r.date.setMonth(u+f)):n.type=="week"?(o&&(u=e[0].startdate.getMonth()),r.date.setMonth(e[0].startdate.getMonth()),r.date.setDate(u+f*7)):n.type=="day"?(o&&(u=e[0].startdate.getDate()),r.date.setMonth(e[0].startdate.getMonth()),r.date.setDate(u+f)):n.type=="hour"?(o&&(u=e[0].startdate.getHours()),r.date.setMonth(e[0].startdate.getMonth()),r.date.setDate(e[0].startdate.getDate()),r.date.setHours(u+f)):n.type=="minute"?(o&&(u=e[0].startdate.getMinutes()),r.date.setMonth(e[0].startdate.getMonth()),r.date.setDate(e[0].startdate.getDate()),r.date.setHours(e[0].startdate.getHours()),r.date.setMinutes(u+f)):n.type=="second"?(o&&(u=e[0].startdate.getSeconds()),r.date.setMonth(e[0].startdate.getMonth()),r.date.setDate(e[0].startdate.getDate()),r.date.setHours(e[0].startdate.getHours()),r.date.setMinutes(e[0].startdate.getMinutes()),r.date.setSeconds(u+f)):n.type=="millisecond"&&(o&&(u=e[0].startdate.getMilliseconds()),r.date.setMonth(e[0].startdate.getMonth()),r.date.setDate(e[0].startdate.getDate()),r.date.setHours(e[0].startdate.getHours()),r.date.setMinutes(e[0].startdate.getMinutes()),r.date.setSeconds(e[0].startdate.getSeconds()),r.date.setMilliseconds(u+f)),VMM.Browser.browser=="Firefox"&&(r.date.getFullYear()=="1970"&&r.date.getTimezoneOffset()!=a?(trace("FIREFOX 1970 TIMEZONE OFFSET "+r.date.getTimezoneOffset()+" SHOULD BE "+a),trace(n.type+" "+n.date),c.offset=r.date.getTimezoneOffset()/60,c.flag=!0,r.date.setHours(r.date.getHours()+c.offset)):c.flag&&(c.flag=!1,r.date.setHours(r.date.getHours()+c.offset),h&&(c.flag=!0))),r.date_string=h?r.date.getFullYear()<0?Math.abs(r.date.getFullYear()).toString()+" B.C.":r.date.getFullYear():VMM.Date.prettyDate(r.date,!0),f=f+1,o=!1,r.relative_pos=bt(s,r.date),y=r.relative_pos.begin,r.relative_pos.begin>l&&(l=r.relative_pos.begin),VMM.appendElement(r.element,r.date_string),VMM.Lib.css(r.element,"text-indent",-(VMM.Lib.width(r.element)/2)),VMM.Lib.css(r.element,"opacity","0"),t.push(r);VMM.Lib.width(ct,l);ot(i,t)}function bi(){var n=0,t=0;if(VMM.attachElement(b,""),y=VMM.appendAndGetElement(b,"<div>","timenav"),wt=VMM.appendAndGetElement(y,"<div>","content"),st=VMM.appendAndGetElement(y,"<div>","time"),kt=VMM.appendAndGetElement(st,"<div>","time-interval-minor"),ct=VMM.appendAndGetElement(kt,"<div>","minor"),ht=VMM.appendAndGetElement(st,"<div>","time-interval-major"),rt=VMM.appendAndGetElement(st,"<div>","time-interval"),ut=VMM.appendAndGetElement(b,"<div>","timenav-background"),dt=VMM.appendAndGetElement(ut,"<div>","timenav-line"),gt=VMM.appendAndGetElement(ut,"<div>","timenav-indicator"),ci=VMM.appendAndGetElement(ut,"<div>","timenav-interval-background","<div class='top-highlight'><\/div>"),w=VMM.appendAndGetElement(b,"<div>","vco-toolbar"),ki(),di(),gi(),pi(),oi(!1),si(),ot(rt,it,!1,!0),ot(ht,ft),u.start_page&&($backhome=VMM.appendAndGetElement(w,"<div>","back-home","<div class='icon'><\/div>"),VMM.bindEvent(".back-home",li,"click"),VMM.Lib.attribute($backhome,"title",VMM.master_config.language.messages.return_to_title),VMM.Lib.attribute($backhome,"rel","timeline-tooltip")),d=new VMM.DragSlider,d.createPanel(b,y,u.nav.constraint,u.touch),u.touch&&u.start_page?(VMM.Lib.addClass(w,"touch"),VMM.Lib.css(w,"top",55),VMM.Lib.css(w,"left",10)):(u.start_page&&VMM.Lib.css(w,"top",27),lt=VMM.appendAndGetElement(w,"<div>","zoom-in","<div class='icon'><\/div>"),at=VMM.appendAndGetElement(w,"<div>","zoom-out","<div class='icon'><\/div>"),VMM.bindEvent(lt,ri,"click"),VMM.bindEvent(at,ui,"click"),VMM.Lib.attribute(lt,"title",VMM.master_config.language.messages.expand_timeline),VMM.Lib.attribute(lt,"rel","timeline-tooltip"),VMM.Lib.attribute(at,"title",VMM.master_config.language.messages.contract_timeline),VMM.Lib.attribute(at,"rel","timeline-tooltip"),w.tooltip({selector:"div[rel=timeline-tooltip]",placement:"right"}),VMM.bindEvent(b,fi,"DOMMouseScroll"),VMM.bindEvent(b,fi,"mousewheel")),u.nav.zoom.adjust!=0)if(u.nav.zoom.adjust<0)for(n=0;n<Math.abs(u.nav.zoom.adjust);n++)ui();else for(t=0;t<u.nav.zoom.adjust;t++)ri();ni=!0;ti(!0);VMM.fireEvent(b,"LOADED")}function ki(){var n=0,t=0;for(o=et(e[e.length-1].enddate-e[0].startdate,!0),trace(o),wi(),o.centuries>e.length/u.nav.density?(s=f.century,p=f.millenium,k=f.decade):o.decades>e.length/u.nav.density?(s=f.decade,p=f.century,k=f.year):o.years>e.length/u.nav.density?(s=f.year,p=f.decade,k=f.month):o.months>e.length/u.nav.density?(s=f.month,p=f.year,k=f.day):o.days>e.length/u.nav.density?(s=f.day,p=f.month,k=f.hour):o.hours>e.length/u.nav.density?(s=f.hour,p=f.day,k=f.minute):o.minutes>e.length/u.nav.density?(s=f.minute,p=f.hour,k=f.second):o.seconds>e.length/u.nav.density?(s=f.second,p=f.minute,k=f.second):(trace("NO IDEA WHAT THE TYPE SHOULD BE"),s=f.day,p=f.month,k=f.hour),trace("INTERVAL TYPE: "+s.type),trace("INTERVAL MAJOR TYPE: "+p.type),hi(s,it,rt),hi(p,ft,ht),n=0;n<it.length;n++)for(t=0;t<ft.length;t++)it[n].date_string==ft[t].date_string&&VMM.attachElement(it[n].element,"")}function di(){var n=0,i=0,l=0,r,f,o,k,w,b,y,t,c,p,a;for(h=[],vt=[],n=0;n<e.length;n++)t="",c=!1,r=VMM.appendAndGetElement(wt,"<div>","marker"),f=VMM.appendAndGetElement(r,"<div>","flag"),o=VMM.appendAndGetElement(f,"<div>","flag-content"),k=VMM.appendAndGetElement(r,"<div>","dot"),w=VMM.appendAndGetElement(r,"<div>","line"),b=VMM.appendAndGetElement(w,"<div>","event-line"),_marker_relative_pos=bt(s,e[n].startdate,e[n].enddate),_marker_thumb="",e[n].asset!=null&&e[n].asset!=""?VMM.appendElement(o,VMM.MediaElement.thumbnail(e[n].asset,24,24,e[n].uniqueid)):VMM.appendElement(o,"<div style='margin-right:7px;height:50px;width:2px;float:left;'><\/div>"),e[n].title==""||e[n].title==" "?(trace("TITLE NOTHING"),typeof e[n].slug!="undefined"&&e[n].slug!=""?(trace("SLUG"),t=VMM.Util.untagify(e[n].slug),c=!0):(p=VMM.MediaType(e[n].asset.media),p.type=="quote"||p.type=="unknown"?(t=VMM.Util.untagify(p.id),c=!0):c=!1)):e[n].title!=""||e[n].title!=" "?(trace(e[n].title),t=VMM.Util.untagify(e[n].title),c=!0):trace("TITLE SLUG NOT FOUND "+e[n].slug),c?VMM.appendElement(o,"<h3>"+t+"<\/h3>"):(VMM.appendElement(o,"<h3>"+t+"<\/h3>"),VMM.appendElement(o,"<h3 id='marker_content_"+e[n].uniqueid+"'>"+t+"<\/h3>")),VMM.Lib.attr(r,"id",("marker_"+e[n].uniqueid).toString()),VMM.bindEvent(f,ai,"",{number:n}),VMM.bindEvent(f,vi,"mouseenter mouseleave",{number:n,elem:f}),y={marker:r,flag:f,lineevent:b,type:"marker",full:!0,relative_pos:_marker_relative_pos,tag:e[n].tag,pos_left:0},e[n].type=="start"&&(trace("BUILD MARKER HAS START PAGE"),u.start_page=!0,y.type="start"),e[n].type=="storify"&&(y.type="storify"),e[n].tag&&v.push(e[n].tag),h.push(y);for(v=VMM.Util.deDupeArray(v),u.nav.rows.current=v.length>3?u.nav.rows.half:u.nav.rows.full,i=0;i<v.length;i++)i<u.nav.rows.current.length&&(a=VMM.appendAndGetElement(ut,"<div>","timenav-tag"),VMM.Lib.addClass(a,"timenav-tag-row-"+(i+1)),v.length>3?VMM.Lib.addClass(a,"timenav-tag-size-half"):VMM.Lib.addClass(a,"timenav-tag-size-full"),VMM.appendElement(a,"<div><h3>"+v[i]+"<\/h3><\/div>"));if(v.length>3)for(l=0;l<h.length;l++)VMM.Lib.addClass(h[l].flag,"flag-small"),h[l].full=!1}function gi(){for(var i=0,t=0,t=0;t<tt.length;t++){var n={content:VMM.appendAndGetElement(wt,"<div>","era"),text_content:VMM.appendAndGetElement(rt,"<div>","era"),startdate:VMM.Date.parse(tt[t].startDate),enddate:VMM.Date.parse(tt[t].endDate),title:tt[t].headline,uniqueid:VMM.Util.unique_ID(6),tag:"",relative_pos:""},r=VMM.Date.prettyDate(n.startdate),u=VMM.Date.prettyDate(n.enddate);typeof tt[t].tag!="undefined"&&(n.tag=tt[t].tag);n.relative_pos=bt(s,n.startdate,n.enddate);VMM.Lib.attr(n.content,"id",n.uniqueid);VMM.Lib.attr(n.text_content,"id",n.uniqueid+"_text");VMM.Lib.addClass(n.content,"era"+(i+1));VMM.Lib.addClass(n.text_content,"era"+(i+1));i<6?i++:i=0;VMM.appendElement(n.content,"<div>&nbsp;<\/div>");VMM.appendElement(n.text_content,VMM.Util.unlinkify(n.title));vt.push(n)}}trace("VMM.Timeline.TimeNav");var y,wt,st,kt,rt,ht,ut,ci,dt,gt,ct,w,lt,at,d,u=VMM.Timeline.Config,g,o={},b=n,e=[],vt=[],h=[],it=[],ft=[],v=[],nt=0,ni=!1,tt,c={left:"",visible:{left:"",right:""}},l={day:24,month:12,year:10,hour:60,minute:60,second:1e3,decade:10,century:100,millenium:1e3,age:1e6,epoch:1e7,era:1e8,eon:5e8,week:4.34812141,days_in_month:30.4368499,days_in_week:7,weeks_in_month:4.34812141,weeks_in_year:52.177457,days_in_year:365.242199,hours_in_day:24},a={day:864e5,week:7,month:30.4166666667,year:12,hour:24,minute:1440,second:86400,decade:10,century:100,millenium:1e3,age:1e6,epoch:1e7,era:1e8,eon:5e8},s={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"_idd",interval_type:"interval"},p={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"major",interval_type:"interval major"},k={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"_dd_minor",interval_type:"interval minor"},f={day:{},month:{},year:{},hour:{},minute:{},second:{},decade:{},century:{},millenium:{},week:{},age:{},epoch:{},era:{},eon:{}};g=u.nav.marker.height/2;u.nav.rows={full:[1,g*2,g*4],half:[1,g,g*2,g*3,g*4,g*5],current:[]};t!=null&&t!=""&&(u.nav.width=t);r!=null&&r!=""&&(u.nav.height=r);this.init=function(n,t){trace("VMM.Timeline.TimeNav init");typeof n!="undefined"?this.setData(n,t):trace("WAITING ON DATA")};this.setData=function(n,t){typeof n!="undefined"?(e={},e=n,tt=t,bi()):trace("NO DATA")};this.setSize=function(n,t){n!=null&&(u.width=n);t!=null&&(u.height=t);ni&&ti()};this.setMarker=function(n,t,i){yt(n,t,i)};this.getCurrentNumber=function(){return nt}});typeof VMM.Timeline!="undefined"&&typeof VMM.Timeline.DataObj=="undefined"&&(VMM.Timeline.DataObj={data_obj:{},model_array:[],getData:function(n){if(VMM.Timeline.DataObj.data_obj={},VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Timeline.Config.language.messages.loading_timeline),type.of(n)=="object")trace("DATA SOURCE: JSON OBJECT"),VMM.Timeline.DataObj.parseJSON(n);else if(type.of(n)=="string")if(n.match("%23"))trace("DATA SOURCE: TWITTER SEARCH"),VMM.Timeline.DataObj.model.tweets.getData("%23medill");else if(n.match("spreadsheet"))trace("DATA SOURCE: GOOGLE SPREADSHEET"),VMM.Timeline.DataObj.model.googlespreadsheet.getData(n);else if(n.match("storify.com"))trace("DATA SOURCE: STORIFY"),VMM.Timeline.DataObj.model.storify.getData(n);else if(n.match(".jsonp"))trace("DATA SOURCE: JSONP"),LoadLib.js(n,VMM.Timeline.DataObj.onJSONPLoaded);else{trace("DATA SOURCE: JSON");var t="";t=n.indexOf("?")>-1?n+"&callback=onJSONP_Data":n+"?callback=onJSONP_Data";VMM.getJSON(t,VMM.Timeline.DataObj.parseJSON)}else type.of(n)=="html"?(trace("DATA SOURCE: HTML"),VMM.Timeline.DataObj.parseHTML(n)):trace("DATA SOURCE: UNKNOWN")},onJSONPLoaded:function(){trace("JSONP IS LOADED");VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,storyjs_jsonp_data)},parseHTML:function(){var n,t;trace("parseHTML");trace("WARNING: THIS IS STILL ALPHA AND WILL NOT WORK WITH ID's other than #timeline");n=VMM.Timeline.DataObj.data_template_obj;VMM.Lib.find("#timeline section","time")[0]&&(n.timeline.startDate=VMM.Lib.html(VMM.Lib.find("#timeline section","time")[0]),n.timeline.headline=VMM.Lib.html(VMM.Lib.find("#timeline section","h2")),n.timeline.text=VMM.Lib.html(VMM.Lib.find("#timeline section","article")),t=!1,VMM.Lib.find("#timeline section","figure img").length!=0?(t=!0,n.timeline.asset.media=VMM.Lib.attr(VMM.Lib.find("#timeline section","figure img"),"src")):VMM.Lib.find("#timeline section","figure a").length!=0&&(t=!0,n.timeline.asset.media=VMM.Lib.attr(VMM.Lib.find("#timeline section","figure a"),"href")),t&&(VMM.Lib.find("#timeline section","cite").length!=0&&(n.timeline.asset.credit=VMM.Lib.html(VMM.Lib.find("#timeline section","cite"))),VMM.Lib.find(this,"figcaption").length!=0&&(n.timeline.asset.caption=VMM.Lib.html(VMM.Lib.find("#timeline section","figcaption")))));VMM.Lib.each("#timeline li",function(){var r=!1,t={type:"default",startDate:"",headline:"",text:"",asset:{media:"",credit:"",caption:""},tags:"Optional"},i;VMM.Lib.find(this,"time")!=0&&(r=!0,t.startDate=VMM.Lib.html(VMM.Lib.find(this,"time")[0]),VMM.Lib.find(this,"time")[1]&&(t.endDate=VMM.Lib.html(VMM.Lib.find(this,"time")[1])),t.headline=VMM.Lib.html(VMM.Lib.find(this,"h3")),t.text=VMM.Lib.html(VMM.Lib.find(this,"article")),i=!1,VMM.Lib.find(this,"figure img").length!=0?(i=!0,t.asset.media=VMM.Lib.attr(VMM.Lib.find(this,"figure img"),"src")):VMM.Lib.find(this,"figure a").length!=0&&(i=!0,t.asset.media=VMM.Lib.attr(VMM.Lib.find(this,"figure a"),"href")),i&&(VMM.Lib.find(this,"cite").length!=0&&(t.asset.credit=VMM.Lib.html(VMM.Lib.find(this,"cite"))),VMM.Lib.find(this,"figcaption").length!=0&&(t.asset.caption=VMM.Lib.html(VMM.Lib.find(this,"figcaption")))),trace(t),n.timeline.date.push(t))});VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,n)},parseJSON:function(n){trace("parseJSON");n.timeline.type=="default"?(trace("DATA SOURCE: JSON STANDARD TIMELINE"),VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,n)):n.timeline.type=="twitter"?(trace("DATA SOURCE: JSON TWEETS"),VMM.Timeline.DataObj.model_Tweets.buildData(n)):(trace("DATA SOURCE: UNKNOWN JSON"),trace(type.of(n.timeline)))},model:{googlespreadsheet:{getData:function(n){function o(){f=VMM.getJSON(i,function(n){clearTimeout(r);VMM.Timeline.DataObj.model.googlespreadsheet.buildData(n)}).error(function(n,t){trace("Google Docs ERROR");trace("Google Docs ERROR: "+t+" "+n.responseText)}).success(function(){clearTimeout(r)})}var f,e,t,i,r,u=0;e=VMM.Util.getUrlVars(n).key;t=VMM.Util.getUrlVars(n).worksheet;typeof t=="undefined"&&(t="od6");i="https://spreadsheets.google.com/feeds/list/"+e+"/"+t+"/public/values?alt=json";r=setTimeout(function(){trace("Google Docs timeout "+i);trace(i);u<3?(VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Still waiting on Google Docs, trying again "+u),u++,f.abort(),o()):VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Google Docs is not responding")},16e3);o()},buildData:function(n){function i(n){return typeof n!="undefined"?n.$t:""}var r=VMM.Timeline.DataObj.data_template_obj,e=!1,f,t,u,o,s;if(VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Parsing Google Doc Data"),typeof n.feed.entry!="undefined")for(e=!0,f=0;f<n.feed.entry.length;f++)t=n.feed.entry[f],u="",typeof t.gsx$type!="undefined"?u=t.gsx$type.$t:typeof t.gsx$titleslide!="undefined"&&(u=t.gsx$titleslide.$t),u.match("start")||u.match("title")?(r.timeline.startDate=i(t.gsx$startdate),r.timeline.headline=i(t.gsx$headline),r.timeline.asset.media=i(t.gsx$media),r.timeline.asset.caption=i(t.gsx$mediacaption),r.timeline.asset.credit=i(t.gsx$mediacredit),r.timeline.text=i(t.gsx$text),r.timeline.type="google spreadsheet"):u.match("era")?(o={startDate:i(t.gsx$startdate),endDate:i(t.gsx$enddate),headline:i(t.gsx$headline),text:i(t.gsx$text),tag:i(t.gsx$tag)},r.timeline.era.push(o)):(s={type:"google spreadsheet",startDate:i(t.gsx$startdate),endDate:i(t.gsx$enddate),headline:i(t.gsx$headline),text:i(t.gsx$text),tag:i(t.gsx$tag),asset:{media:i(t.gsx$media),credit:i(t.gsx$mediacredit),caption:i(t.gsx$mediacaption),thumbnail:i(t.gsx$mediathumbnail)}},r.timeline.date.push(s));e?(VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Finished Parsing Data"),VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,r)):(VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Language.messages.loading+" Google Doc Data (cells)"),trace("There may be too many entries. Still trying to load data. Now trying to load cells to avoid Googles limitation on cells"),VMM.Timeline.DataObj.model.googlespreadsheet.getDataCells(n.feed.link[0].href))},getDataCells:function(n){function e(){u=VMM.getJSON(t,function(n){clearTimeout(i);VMM.Timeline.DataObj.model.googlespreadsheet.buildDataCells(n)}).error(function(n,t){trace("Google Docs ERROR");trace("Google Docs ERROR: "+t+" "+n.responseText)}).success(function(){clearTimeout(i)})}var u,f,t,i,r=0;f=VMM.Util.getUrlVars(n).key;t="https://spreadsheets.google.com/feeds/cells/"+f+"/od6/public/values?alt=json";i=setTimeout(function(){trace("Google Docs timeout "+t);trace(t);r<3?(VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Still waiting on Google Docs, trying again "+r),r++,u.abort(),e()):VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Google Docs is not responding")},16e3);e()},buildDataCells:function(n){function a(n){return typeof n!="undefined"?n.$t:""}var f=VMM.Timeline.DataObj.data_template_obj,h=!1,c=["timeline"],o=[],s=0,r=0,e,l,t;if(VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Language.messages.loading_timeline+" Parsing Google Doc Data (cells)"),typeof n.feed.entry!="undefined"){for(h=!0,r=0;r<n.feed.entry.length;r++)e=n.feed.entry[r],parseInt(e.gs$cell.row)>s&&(s=parseInt(e.gs$cell.row));for(r=0;r<s+1;r++)t={type:"",startDate:"",endDate:"",headline:"",text:"",tag:"",asset:{media:"",credit:"",caption:"",thumbnail:""}},o.push(t);for(r=0;r<n.feed.entry.length;r++){var e=n.feed.entry[r],u="",i={content:a(e.gs$cell),col:e.gs$cell.col,row:e.gs$cell.row,name:""};i.row==1?(i.content=="Start Date"?u="startDate":i.content=="End Date"?u="endDate":i.content=="Headline"?u="headline":i.content=="Text"?u="text":i.content=="Media"?u="media":i.content=="Media Credit"?u="credit":i.content=="Media Caption"?u="caption":i.content=="Media Thumbnail"?u="thumbnail":i.content=="Type"?u="type":i.content=="Tag"&&(u="tag"),c.push(u)):(i.name=c[i.col],o[i.row][i.name]=i.content)}for(r=0;r<o.length;r++)t=o[r],t.type.match("start")||t.type.match("title")?(f.timeline.startDate=t.startDate,f.timeline.headline=t.headline,f.timeline.asset.media=t.media,f.timeline.asset.caption=t.caption,f.timeline.asset.credit=t.credit,f.timeline.text=t.text,f.timeline.type="google spreadsheet"):t.type.match("era")?(l={startDate:t.startDate,endDate:t.endDate,headline:t.headline,text:t.text,tag:t.tag},f.timeline.era.push(l)):(t={type:"google spreadsheet",startDate:t.startDate,endDate:t.endDate,headline:t.headline,text:t.text,tag:t.tag,asset:{media:t.media,credit:t.credit,caption:t.caption,thumbnail:t.thumbnail}},f.timeline.date.push(t))}h?(VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Finished Parsing Data"),VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,f)):VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Unable to load Google Doc data source")}},storify:{getData:function(n){var t,i,r;VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Loading Storify...");t=n.split("storify.com/")[1];i="http://api.storify.com/v1/stories/"+t+"?per_page=300&callback=?";r=setTimeout(function(){trace("STORIFY timeout");VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Storify is not responding")},6e3);VMM.getJSON(i,VMM.Timeline.DataObj.model.storify.buildData).error(function(n,t){trace("STORIFY error");trace("STORIFY ERROR: "+t+" "+n.responseText)}).success(function(){clearTimeout(r)})},buildData:function(n){var f,r,i,c,l,e;VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Parsing Data");f=VMM.Timeline.DataObj.data_template_obj;f.timeline.startDate=new Date(n.content.date.created);f.timeline.headline=n.content.title;trace(n);var u="",o=n.content.author.username,s="";for(typeof n.content.author.name!="undefined"&&(o=n.content.author.name,s=n.content.author.username+"&nbsp;"),typeof n.content.description!="undefined"&&n.content.description!=null&&(u+=n.content.description),u+="<div class='storify'>",u+="<div class='vcard author'><a class='screen-name url' href='"+n.content.author.permalink+"' target='_blank'>",u+="<span class='avatar'><img src='"+n.content.author.avatar+"' style='max-width: 32px; max-height: 32px;'><\/span>",u+="<span class='fn'>"+o+"<\/span>",u+="<span class='nickname'>"+s+"<span class='thumbnail-inline'><\/span><\/span>",u+="<\/a>",u+="<\/div>",u+="<\/div>",f.timeline.text=u,f.timeline.asset.media=n.content.thumbnail,f.timeline.type="storify",r=0;r<n.content.elements.length;r++){var t=n.content.elements[r],h=!1,a=new Date(t.posted_at);trace(t.type);i={type:"storify",startDate:t.posted_at,endDate:t.posted_at,headline:" ",slug:"",text:"",asset:{media:"",credit:"",caption:""}};t.type=="image"?(typeof t.source.name!="undefined"?t.source.name=="flickr"?(i.asset.media="http://flickr.com/photos/"+t.meta.pathalias+"/"+t.meta.id+"/",i.asset.credit="<a href='"+i.asset.media+"'>"+t.attribution.name+"<\/a>",i.asset.credit+=" on <a href='"+t.source.href+"'>"+t.source.name+"<\/a>"):t.source.name=="instagram"?(i.asset.media=t.permalink,i.asset.credit="<a href='"+t.permalink+"'>"+t.attribution.name+"<\/a>",i.asset.credit+=" on <a href='"+t.source.href+"'>"+t.source.name+"<\/a>"):(i.asset.credit="<a href='"+t.permalink+"'>"+t.attribution.name+"<\/a>",typeof t.source.href!="undefined"&&(i.asset.credit+=" on <a href='"+t.source.href+"'>"+t.source.name+"<\/a>"),i.asset.media=t.data.image.src):(i.asset.credit="<a href='"+t.permalink+"'>"+t.attribution.name+"<\/a>",i.asset.media=t.data.image.src),i.slug=t.attribution.name,typeof t.data.image.caption!="undefined"&&t.data.image.caption!="undefined"&&(i.asset.caption=t.data.image.caption,i.slug=t.data.image.caption)):t.type=="quote"?t.permalink.match("twitter")?(i.asset.media=t.permalink,i.slug=VMM.Util.untagify(t.data.quote.text)):t.permalink.match("storify")&&(h=!0,i.asset.media="<blockquote>"+t.data.quote.text.replace(/<\s*\/?\s*b\s*.*?>/g,"")+"<\/blockquote>"):t.type=="link"?(i.headline=t.data.link.title,i.text=t.data.link.description,i.asset.media=t.data.link.thumbnail!="undefined"&&t.data.link.thumbnail!=""?t.data.link.thumbnail:t.permalink,i.asset.caption="<a href='"+t.permalink+"' target='_blank'>"+t.data.link.title+"<\/a>",i.slug=t.data.link.title):t.type=="text"?t.permalink.match("storify")&&(h=!0,c=n.content.author.username,l="",typeof t.attribution.name!="undefined"&&(o=t.attribution.name,s=t.attribution.username+"&nbsp;"),e="<div class='storify'>",e+="<blockquote><p>"+t.data.text.replace(/<\s*\/?\s*b\s*.*?>/g,"")+"<\/p><\/blockquote>",e+="<div class='vcard author'><a class='screen-name url' href='"+t.attribution.href+"' target='_blank'>",e+="<span class='avatar'><img src='"+t.attribution.thumbnail+"' style='max-width: 32px; max-height: 32px;'><\/span>",e+="<span class='fn'>"+o+"<\/span>",e+="<span class='nickname'>"+s+"<span class='thumbnail-inline'><\/span><\/span>",e+="<\/a><\/div><\/div>",i.text=e,r+1>=n.content.elements.length?i.startDate=n.content.elements[r-1].posted_at:n.content.elements[r+1].type=="text"&&n.content.elements[r+1].permalink.match("storify")?r+2>=n.content.elements.length?i.startDate=n.content.elements[r-1].posted_at:n.content.elements[r+2].type=="text"&&n.content.elements[r+2].permalink.match("storify")?r+3>=n.content.elements.length?i.startDate=n.content.elements[r-1].posted_at:n.content.elements[r+3].type=="text"&&n.content.elements[r+3].permalink.match("storify")?i.startDate=n.content.elements[r-1].posted_at:(trace("LEVEL 3"),i.startDate=n.content.elements[r+3].posted_at):(trace("LEVEL 2"),i.startDate=n.content.elements[r+2].posted_at):(trace("LEVEL 1"),i.startDate=n.content.elements[r+1].posted_at),i.endDate=i.startDate):t.type=="video"?(i.headline=t.data.video.title,i.asset.caption=t.data.video.description,i.asset.caption=t.source.username,i.asset.media=t.data.video.src):(trace("NO MATCH "),trace(t));h&&(i.slug=VMM.Util.untagify(t.data.text));f.timeline.date.push(i)}VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,f)}},tweets:{type:"twitter",buildData:function(n){VMM.bindEvent(global,VMM.Timeline.DataObj.model.tweets.onTwitterDataReady,"TWEETSLOADED");VMM.ExternalAPI.twitter.getTweets(n.timeline.tweets)},getData:function(n){VMM.bindEvent(global,VMM.Timeline.DataObj.model.tweets.onTwitterDataReady,"TWEETSLOADED");VMM.ExternalAPI.twitter.getTweetSearch(n)},onTwitterDataReady:function(n,t){for(var r,u=VMM.Timeline.DataObj.data_template_obj,i=0;i<t.tweetdata.length;i++)r={type:"tweets",startDate:"",headline:"",text:"",asset:{media:"",credit:"",caption:""},tags:"Optional"},r.startDate=t.tweetdata[i].raw.created_at,r.headline=type.of(t.tweetdata[i].raw.from_user_name)?t.tweetdata[i].raw.from_user_name+" (<a href='https://twitter.com/"+t.tweetdata[i].raw.from_user+"'>@"+t.tweetdata[i].raw.from_user+"<\/a>)":t.tweetdata[i].raw.user.name+" (<a href='https://twitter.com/"+t.tweetdata[i].raw.user.screen_name+"'>@"+t.tweetdata[i].raw.user.screen_name+"<\/a>)",r.asset.media=t.tweetdata[i].content,u.timeline.date.push(r);VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,u)}}},data_template_obj:{timeline:{headline:"",description:"",asset:{media:"",credit:"",caption:""},date:[],era:[]}},date_obj:{startDate:"2012,2,2,11,30",headline:"",text:"",asset:{media:"http://youtu.be/vjVfu8-Wp6s",credit:"",caption:""},tags:"Optional"}});
//# sourceMappingURL=timeline.min.js.map
