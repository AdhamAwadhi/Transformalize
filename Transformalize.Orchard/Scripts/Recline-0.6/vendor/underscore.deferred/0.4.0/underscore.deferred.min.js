(function(n){function b(n){var t=y[n]={};return i(n.split(/\s+/),function(n){t[n]=!0}),t}var e={},u=Array.prototype,o=Object.prototype,p=o.hasOwnProperty,w=o.toString,s=u.forEach,h=u.indexOf,f=u.slice,i=function(n,t,i){var u,r,f;if(n)if(s&&n.forEach===s)n.forEach(t,i);else if(n.length===+n.length){for(r=0,f=n.length;r<f;r++)if(r in n&&t.call(i,n[r],r,n)===e)return}else for(u in n)if(p.call(n,u)&&t.call(i,n[u],u,n)===e)return},r=function(n){return!!(n&&n.constructor&&n.call&&n.apply)},c=function(n){return i(f.call(arguments,1),function(t){for(var i in t)t[i]!==void 0&&(n[i]=t[i])}),n},l=function(n,t,i){var r;if(t){if(h)return h.call(t,n,i);for(r=t.length,i=i?i<0?Math.max(0,r+i):i:0;i<r;i++)if(i in t&&t[i]===n)return i}return-1},a={};i("Boolean Number String Function Array Date RegExp Object".split(" "),function(n){a["[object "+n+"]"]=n.toLowerCase()});var v=function(n){return n==null?String(n):a[w.call(n)]||"object"},t={},y={};t.Callbacks=function(n){n=typeof n=="string"?y[n]||b(n):c({},n);var u,h,e,a,o,f,t=[],r=!n.once&&[],p=function(i){for(u=n.memory&&i,h=!0,f=a||0,a=0,o=t.length,e=!0;t&&f<o;f++)if(t[f].apply(i[0],i[1])===!1&&n.stopOnFalse){u=!1;break}e=!1;t&&(r?r.length&&p(r.shift()):u?t=[]:s.disable())},s={add:function(){if(t){var r=t.length;(function f(r){i(r,function(i){var r=v(i);r==="function"?n.unique&&s.has(i)||t.push(i):i&&i.length&&r!=="string"&&f(i)})})(arguments);e?o=t.length:u&&(a=r,p(u))}return this},remove:function(){return t&&i(arguments,function(n){for(var i;(i=l(n,t,i))>-1;)t.splice(i,1),e&&(i<=o&&o--,i<=f&&f--)}),this},has:function(n){return l(n,t)>-1},empty:function(){return t=[],this},disable:function(){return t=r=u=undefined,this},disabled:function(){return!t},lock:function(){return r=undefined,u||s.disable(),this},locked:function(){return!r},fireWith:function(n,i){return i=i||[],i=[n,i.slice?i.slice():i],t&&(!h||r)&&(e?r.push(i):p(i)),this},fire:function(){return s.fireWith(this,arguments),this},fired:function(){return!!h}};return s};t.Deferred=function(n){var e=[["resolve","done",t.Callbacks("once memory"),"resolved"],["reject","fail",t.Callbacks("once memory"),"rejected"],["notify","progress",t.Callbacks("memory")]],o="pending",f={state:function(){return o},always:function(){return u.done(arguments).fail(arguments),this},then:function(){var n=arguments;return t.Deferred(function(t){i(e,function(i,f){var e=i[0],o=n[f];u[i[1]](r(o)?function(){var n;try{n=o.apply(this,arguments)}catch(i){t.reject(i);return}n&&r(n.promise)?n.promise().done(t.resolve).fail(t.reject).progress(t.notify):t[e!=="notify"?"resolveWith":e+"With"](this===u?t:this,[n])}:t[e])});n=null}).promise()},promise:function(n){return n!=null?c(n,f):f}},u={};return f.pipe=f.then,i(e,function(n,t){var i=n[2],r=n[3];f[n[1]]=i.add;r&&i.add(function(){o=r},e[t^1][2].disable,e[2][2].lock);u[n[0]]=i.fire;u[n[0]+"With"]=i.fireWith}),f.promise(u),n&&n.call(u,u),u};t.when=function(n){var i=0,e=v(n)==="array"&&arguments.length===1?n:f.call(arguments),u=e.length,s=u!==1||n&&r(n.promise)?u:0,o=s===1?n:t.Deferred(),l=function(n,t,i){return function(r){t[n]=this;i[n]=arguments.length>1?f.call(arguments):r;i===h?o.notifyWith(t,i):--s||o.resolveWith(t,i)}},h,a,c;if(u>1)for(h=new Array(u),a=new Array(u),c=new Array(u);i<u;i++)e[i]&&r(e[i].promise)?e[i].promise().done(l(i,c,e)).fail(o.reject).progress(l(i,a,h)):--s;return s||o.resolveWith(c,e),o.promise()};typeof module!="undefined"&&module.exports?module.exports=t:typeof n._!="undefined"?n._.mixin(t):n._=t})(this);
//# sourceMappingURL=underscore.deferred.min.js.map
