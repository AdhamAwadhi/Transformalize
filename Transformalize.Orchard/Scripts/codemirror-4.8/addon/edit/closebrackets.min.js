(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){function i(n,i){var r=n.getRange(t(i.line,i.ch-1),t(i.line,i.ch+1));return r.length==2?r:null}function e(t,i,r){var e=t.getLine(i.line),f=t.getTokenAt(i),u,o;if(/\bstring2?\b/.test(f.type))return!1;for(u=new n.StringStream(e.slice(0,i.ch)+r+e.slice(i.ch),4),u.pos=u.start=f.start;;){if(o=t.getMode().token(u,f.state),u.pos>=i.ch+1)return/\bstring2?\b/.test(o);u.start=u.pos}}function o(r){for(var o={name:"autoCloseBrackets",Backspace:function(u){var e,s,f,o;if(u.getOption("disableInput"))return n.Pass;for(e=u.listSelections(),f=0;f<e.length;f++)if(!e[f].empty()||(s=i(u,e[f].head),!s||r.indexOf(s)%2!=0))return n.Pass;for(f=e.length-1;f>=0;f--)o=e[f].head,u.replaceRange("",t(o.line,o.ch-1),t(o.line,o.ch+1))}},s="",u=0;u<r.length;u+=2)(function(i,r){s+=r;o["'"+i+"'"]=function(u){var v,h,l,a;if(u.getOption("disableInput"))return n.Pass;for(v=u.listSelections(),a=0;a<v.length;a++){var y=v[a],o=y.head,c,l=u.getRange(o,t(o.line,o.ch+1));if(y.empty())if(i==r&&l==r)c=u.getRange(o,t(o.line,o.ch+3))==i+i+i?"skipThree":"skip";else if(i==r&&o.ch>1&&u.getRange(t(o.line,o.ch-2),o)==i+i&&(o.ch<=2||u.getRange(t(o.line,o.ch-3),t(o.line,o.ch-2))!=i))c="addFour";else if(i=='"'||i=="'")if(!n.isWordChar(l)&&e(u,o,i))c="both";else return n.Pass;else if(u.getLine(o.line).length==o.ch||s.indexOf(l)>=0||f.test(l))c="both";else return n.Pass;else c="surround";if(h){if(h!=c)return n.Pass}else h=c}u.operation(function(){var t,n;if(h=="skip")u.execCommand("goCharRight");else if(h=="skipThree")for(n=0;n<3;n++)u.execCommand("goCharRight");else if(h=="surround"){for(t=u.getSelections(),n=0;n<t.length;n++)t[n]=i+t[n]+r;u.replaceSelections(t,"around")}else h=="both"?(u.replaceSelection(i+r,null),u.execCommand("goCharLeft")):h=="addFour"&&(u.replaceSelection(i+i+i+i,"before"),u.execCommand("goCharRight"))})};i!=r&&(o["'"+r+"'"]=function(i){for(var u,e=i.listSelections(),f=0;f<e.length;f++)if(u=e[f],!u.empty()||i.getRange(u.head,t(u.head.line,u.head.ch+1))!=r)return n.Pass;i.execCommand("goCharRight")})})(r.charAt(u),r.charAt(u+1));return o}function s(t){return function(r){var u,f,e;if(r.getOption("disableInput"))return n.Pass;for(u=r.listSelections(),f=0;f<u.length;f++)if(!u[f].empty()||(e=i(r,u[f].head),!e||t.indexOf(e)%2!=0))return n.Pass;r.operation(function(){var n,t;for(r.replaceSelection("\n\n",null),r.execCommand("goCharLeft"),u=r.listSelections(),n=0;n<u.length;n++)t=u[n].head.line,r.indentLine(t,null,!0),r.indentLine(t+1,null,!0)})}}var r="()[]{}''\"\"",u="[]{}",f=/\s/,t=n.Pos;n.defineOption("autoCloseBrackets",!1,function(t,i,f){var e,h,c;(f!=n.Init&&f&&t.removeKeyMap("autoCloseBrackets"),i)&&(e=r,h=u,typeof i=="string"?e=i:typeof i=="object"&&(i.pairs!=null&&(e=i.pairs),i.explode!=null&&(h=i.explode)),c=o(e),h&&(c.Enter=s(h)),t.addKeyMap(c))})});
//# sourceMappingURL=closebrackets.min.js.map
