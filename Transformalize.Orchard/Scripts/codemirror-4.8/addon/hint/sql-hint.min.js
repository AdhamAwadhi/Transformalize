(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror"),require("../../mode/sql/sql")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../../mode/sql/sql"],n):n(CodeMirror)})(function(n){"use strict";function h(t){var i=t.doc.modeOption;return i==="sql"&&(i="text/x-sql"),n.resolveMode(i).keywords}function c(n,t){var i=n.length,r=t.substr(0,i);return n.toUpperCase()===r.toUpperCase()}function i(n,t,i,r){for(var u in i)i.hasOwnProperty(u)&&(Array.isArray(i)&&(u=i[u]),c(t,u)&&n.push(r(u)))}function l(n,f){var c=f.getCursor(),o=f.getTokenAt(c),y=o.string.charAt(0)=="`",e=o.string.substr(1),l=f.getTokenAt(t(c.line,o.start)),s,a,h;if(o.string.charAt(0)=="."||l.string=="."){if(l.string=="."&&(l=f.getTokenAt(t(c.line,o.start-1))),s=l.string,a=!1,s.match(/`/g)&&(a=!0,s=s.replace(/`/g,"")),r.hasOwnProperty(s)||(s=v(s,f)),h=r[s],!h)return;y?i(n,e,h,function(n){return"`"+n+"`"}):a?i(n,e,h,function(n){return".`"+n+"`"}):i(n,e,h,function(n){return"."+n})}else{while(o.start&&e.charAt(0)==".")o=f.getTokenAt(t(c.line,o.start-1)),e=o.string+e;y?(i(n,e,r,function(n){return"`"+n+"`"}),i(n,e,u,function(n){return"`"+n+"`"})):(i(n,e,r,function(n){return n}),i(n,e,u,function(n){return n}))}}function a(n,t){var u,r,i;if(n)for(u=/[,;]/g,r=n.split(" "),i=0;i<r.length;i++)t(r[i]?r[i].replace(u,""):"")}function o(n){return n.line+n.ch/Math.pow(10,6)}function s(n){return t(Math.floor(n),+n.toString().split(".").pop())}function v(n,i){for(var v=i.doc,d=v.getValue(),nt=n.toUpperCase(),y="",p="",f=[],w={start:t(0,0),end:t(i.lastLine(),i.getLineHandle(i.lastLine()).length)},h=d.indexOf(e.QUERY_DIV),c,b,l,k,u,g;h!=-1;)f.push(v.posFromIndex(h)),h=d.indexOf(e.QUERY_DIV,h+1);for(f.unshift(t(0,0)),f.push(t(i.lastLine(),i.getLineHandle(i.lastLine()).text.length)),c=0,b=o(i.getCursor()),u=0;u<f.length;u++){if(l=o(f[u]),b>c&&b<=l){w={start:s(c),end:s(l)};break}c=l}for(k=v.getRange(w.start,w.end,!1),u=0;u<k.length;u++)if(g=k[u],a(g,function(n){var t=n.toUpperCase();t===nt&&r.hasOwnProperty(y)&&(p=y);t!==e.ALIAS_KEYWORD&&(y=n)}),p)break;return p}var r,u,f,e={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},t=n.Pos;n.registerHelper("hint","sql",function(n,e){var v;r=e&&e.tables||{};v=e&&e.defaultTable;u=v&&r[v]||[];f=f||h(n);var c=n.getCursor(),s=[],a=n.getTokenAt(c),y,p,o;return a.string.match(/^[.`\w@]\w*$/)?(o=a.string,y=a.start,p=a.end):(y=p=c.ch,o=""),o.charAt(0)=="."||o.charAt(0)=="`"?l(s,n):(i(s,o,r,function(n){return n}),i(s,o,u,function(n){return n}),i(s,o,f,function(n){return n.toUpperCase()})),{list:s,from:t(c.line,y),to:t(c.line,p)}})});
//# sourceMappingURL=sql-hint.min.js.map
